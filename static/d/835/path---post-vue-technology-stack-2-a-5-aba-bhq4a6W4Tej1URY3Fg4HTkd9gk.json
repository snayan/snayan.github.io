{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三洋的小站","author":"三洋"}},"markdownRemark":{"id":"a7c66256-7f1f-546b-b6c6-6d5ff325626f","excerpt":"目的这个项目主要是用 vue+vuex 实现一个单页面应用，纯粹是熟悉 vue 全家桶相关开发模式，用于练手非常合适。\n着手开发完了之后可以学的东西：熟悉 vue 单文件组件开发方式熟悉如何写一个 vue 插件熟悉如何使用 vue-router 以及挂载路由钩子函数熟悉 vuex…","html":"<h2>目的</h2>\n<p>这个项目主要是用 vue+vuex 实现一个单页面应用，纯粹是熟悉 vue 全家桶相关开发模式，用于练手非常合适。\n着手开发完了之后可以学的东西：</p>\n<ol>\n<li>熟悉 vue 单文件组件开发方式</li>\n<li>熟悉如何写一个 vue 插件</li>\n<li>熟悉如何使用 vue-router 以及挂载路由钩子函数</li>\n<li>熟悉 vuex 是如何运作的，模块化维护应用状态数据</li>\n<li>体验 typescript 的开发方式\n如果想学 vue 的不妨进来看看。\n项目源码地址：<a href=\"https://github.com/snayan/vue-task\">点击这里</a></li>\n</ol>\n<h2>技术栈</h2>\n<ul>\n<li>vue</li>\n<li>vuex</li>\n<li>vue-router</li>\n<li>typescript</li>\n</ul>\n<!--more-->\n<h2>开始</h2>\n<p>开始之前，还是有必要去 vue 官网学习一下 vue，至少得有个大致的了解，后面在用到 vue-router 和 vuex 时，再去对应的仓库看文档就可以了。</p>\n<ul>\n<li><a href=\"https://cn.vuejs.org/v2/guide/\">vue 官网地址</a></li>\n<li><a href=\"https://router.vuejs.org/\">vue-router 地址</a></li>\n<li><a href=\"https://vuex.vuejs.org/\">vuex 地址</a>\n创建项目可以用 vue-cli，具体看<a href=\"https://github.com/vuejs/vue-cli/blob/dev/docs/README.md\">这里</a></li>\n</ul>\n<h2>结构</h2>\n<p>项目结构一般来说非常重要，定义好的目录结构，非常利于后续的项目维护，以及别人阅读理解。下面就是这个项目的结构，应该看一下就知道是干什么的，大致说一下。\n项目结构分为静态资源目录，api 接口请求目录，组件目录，插件目录，路由配置目录，公共样式目录，状态维护目录，工具类目录，页面视图目录。\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77f26178714fcfd80de8a06f8e44a4ee/0c499/vue-structure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 78.04878048780488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQoz5WT2W7DIBBF/SuR2QdqnMVxbDaDSSulatU+9v8/pKTNays8ukJI6MKZ0aVZvX5/dZ0+YEwoZZiQsqlUMy6HcDWX0Qzn8zTPuu8RwrVmvujxZtawKvVECC2qsf1W007yuOpBd231gwgRzpjgrBFK2KysNYxyhDc0fMeWAvw4pJSctYxSWjewB7YE+EhsdcfnZcp+OO1V25bzOmwl4SuQdXE5XwGAbMJWADfbLSHMsylXbutZCfl2iTHETvftfeKbBibli9MpxuNpKF5yDxmtVNP1fZ5wTFF2PQPJpapXAwI+B5lCOI+X+mA+sDGm+OlknQ9hAZAlnozx8kNqclrMZKf2MaaccwjBGFtW59w8lcwx9APzVzUt5bsefMrWJ+MjFQozIEwSLhEV/+sb3fqd0njUfL0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"vue structure\"\n        title=\"\"\n        src=\"/static/77f26178714fcfd80de8a06f8e44a4ee/b9e4f/vue-structure.png\"\n        srcset=\"/static/77f26178714fcfd80de8a06f8e44a4ee/cf440/vue-structure.png 148w,\n/static/77f26178714fcfd80de8a06f8e44a4ee/d2d38/vue-structure.png 295w,\n/static/77f26178714fcfd80de8a06f8e44a4ee/b9e4f/vue-structure.png 590w,\n/static/77f26178714fcfd80de8a06f8e44a4ee/f9b6a/vue-structure.png 885w,\n/static/77f26178714fcfd80de8a06f8e44a4ee/0c499/vue-structure.png 902w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h2>单页面组件</h2>\n<p>vue 开发一般都是单页面组件的方式，即一个以 vue 为后缀的文件就是一个组件，组件里包含了 template 模版，script 脚本，style 样式，组件内的逻辑可以完全封装在里面，对外可以提供接受的 Props 数据，可以对外发射一个事件 emit，或者将外部组件组合到自己内部的 slot 里面。</p>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class=&quot;topNav&quot;&gt;\n    &lt;ul class=&quot;list&quot;&gt;\n      &lt;li class=&quot;item left&quot;&gt;\n        &lt;app-icon :link=&quot;left&quot; @click.native.stop=&quot;clickLeft&quot; /&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script lang=&quot;ts&quot;&gt;\nimport { Component, Prop, Emit, Vue } from &quot;vue-property-decorator&quot;\nimport AppIcon from &quot;./AppIcon.vue&quot;\nimport { PREFIX } from &quot;@/store/modules/user/CONSTANTS&quot;\n\n@Component({\n  components: {\n    AppIcon,\n  },\n})\nexport default class TopNav extends Vue {\n  @Prop({ required: true })\n  private left!: string\n  private get avatar() {\n    return this.$store.state[PREFIX].avatar\n  }\n  private clickLeft() {\n    this.$emit(&quot;left&quot;)\n  }\n}\n&lt;/script&gt;\n\n&lt;style lang=&quot;scss&quot; scoped&gt;\n@import &quot;../scss/theme.scss&quot;;\n.topNav {\n  background: $topBarBgColor;\n  position: fixed;\n}\n&lt;/style&gt;</code></pre></div>\n<h2>配置路由</h2>\n<p>由于在客户端渲染的单页面应用，需要在客户端配置路由，实现页面间的切换。开发 vue 时官方推荐使用 vue-router，在配置这个项目时，由于考虑登录态的维护，所以对路由配置加了 meta 数据，并增加了路由跳转钩子函数，进行鉴权控制受登录态的页面。</p>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">import Vue from &quot;vue&quot;\nimport Router from &quot;vue-router&quot;\nimport Sign from &quot;@/views/Sign.vue&quot;\nimport Me from &quot;@/views/Me.vue&quot;\nimport { hasLogin } from &quot;@/util/session&quot;\n\nVue.use(Router)\n\nconst router = new Router({\n  mode: &quot;history&quot;,\n  routes: [\n    {\n      path: &quot;/&quot;,\n      name: &quot;sign&quot;,\n      component: Sign,\n    },\n    {\n      path: &quot;/me&quot;,\n      name: &quot;me&quot;,\n      component: Me,\n      meta: { requiredAuth: true },\n    },\n  ],\n})\n\nrouter.beforeEach((to, from, next) =&gt; {\n  if (to.matched.some(record =&gt; record.meta.requiredAuth)) {\n    // this route requires auth, check if logged in\n    // if not, redirect to login page.\n    if (!hasLogin()) {\n      next({\n        path: &quot;/&quot;,\n        query: { redirect: to.fullPath },\n      })\n    } else {\n      next()\n    }\n  } else {\n    next() // 确保一定要调用 next()\n  }\n})\n\nexport default router</code></pre></div>\n<h2>vue 插件编写</h2>\n<p>对于那种需要全组件共享，或者全局注入的方法等可以使用 vue 插件。其实，vue-router 和 vuex 实际就是 vue 的插件，在入口处，调<code class=\"language-text\">Vue.use(Router);</code> 就可以了，比如 <code class=\"language-text\">Vue.use(Router);</code>\n一个插件，可以是一个函数，或者一个包含<code class=\"language-text\">install</code>方法的对象，在调用<code class=\"language-text\">Vue.use</code>时，会调用<code class=\"language-text\">install</code>方法。\n在插件里，我们可以</p>\n<ol>\n<li>添加全局方法或者属性，</li>\n<li>添加全局资源</li>\n<li>通过全局 mixin 方法添加一些组件选项</li>\n<li>添加 Vue 实例方法</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> Vue<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> VueConstructor<span class=\"token punctuation\">,</span> PluginObject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span>\n<span class=\"token keyword\">import</span> Loading <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Loading.vue\"</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token function-variable function\">ShowFunc</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">const</span> plugin<span class=\"token punctuation\">:</span> PluginObject<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">install</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Vue<span class=\"token punctuation\">:</span> VueConstructor<span class=\"token punctuation\">,</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">CONSTRUCTOR</span> <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>Loading<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">let</span> cache<span class=\"token punctuation\">:</span> Vue <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">{</span> show<span class=\"token punctuation\">:</span> ShowFunc <span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">loading</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> loadingComponent <span class=\"token operator\">=</span> cache <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CONSTRUCTOR</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>loadingComponent<span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> loadingComponent<span class=\"token punctuation\">.</span><span class=\"token function\">$mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> loadingComponent<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token class-name\">Vue</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>$loading <span class=\"token operator\">=</span> loading\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> plugin</code></pre></div>\n<h2>状态管理</h2>\n<p>单页面应用的状态管理使用 vuex，上面提到了，它就是一个 vue 的插件，会在组件实例上注入$store 对象，这个对象就是<code class=\"language-text\">new Vuex.Store()</code>,相比 redux ，我觉得 vuex 简单很多。使用需要注意一下几点就可以了，</p>\n<ol>\n<li>改变 state，始终是通过 commit 一个 mutation 方式进行，mutation 函数里必须是同步改变 state，不能异步改变 state。对应 redux 中，就是 reducer 函数的功能了。</li>\n<li>对于异步改变 state，可以通过 dispatch 一个 action，action 里面异步获取数据之后在 commit 一个对应的 mutation。这个在 redux 里，是通过中间件处理异步 action 的。</li>\n<li>对于 state 的过滤筛选，可以定义 getter，getter 是缓存依赖的。</li>\n<li>对于大型复杂的 state，可以采用模块化的方式管理各个模块的 state，这个跟 redux 的思想是一样的。\n本次项目也是用模块化的管理状态的方式，把整个应用的状态以业务划分为子状态，最后在 modules 中合并</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  modules<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    user<span class=\"token punctuation\">,</span>\n    list<span class=\"token punctuation\">,</span>\n    filter<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>对于单个模块的 state，按照上面的注意点即可以。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// user模块的state</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ActionTree<span class=\"token punctuation\">,</span> MutationTree<span class=\"token punctuation\">,</span> ActionContext <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vuex\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> login<span class=\"token punctuation\">,</span> loginOut<span class=\"token punctuation\">,</span> LoginInfo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/api/login\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getUserInfo<span class=\"token punctuation\">,</span> getUserActions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/api/user\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> User <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./user\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> RootState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../rootstate\"</span>\n\n<span class=\"token keyword\">const</span> namespaced <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\n<span class=\"token comment\">/* initial state */</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">state</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  username<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  email<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  avatar<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  likes_count<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  goings_count<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  past_count<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/* user actions */</span>\n<span class=\"token keyword\">const</span> actions<span class=\"token punctuation\">:</span> ActionTree<span class=\"token operator\">&lt;</span>User<span class=\"token punctuation\">,</span> RootState<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> commit<span class=\"token punctuation\">,</span> state <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> ActionContext<span class=\"token operator\">&lt;</span>User<span class=\"token punctuation\">,</span> RootState<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">:</span> LoginInfo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> token<span class=\"token punctuation\">,</span> user <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> token<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> user<span class=\"token punctuation\">:</span> User <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"saveToken\"</span><span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> root<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"saveUser\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> commit<span class=\"token punctuation\">,</span> state <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> ActionContext<span class=\"token operator\">&lt;</span>User<span class=\"token punctuation\">,</span> RootState<span class=\"token operator\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user<span class=\"token punctuation\">:</span> User</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"saveUser\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/* user mutations */</span>\n<span class=\"token keyword\">const</span> mutations<span class=\"token punctuation\">:</span> MutationTree<span class=\"token operator\">&lt;</span>User<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">saveUser</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>id\n    state<span class=\"token punctuation\">.</span>username <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>username\n    state<span class=\"token punctuation\">.</span>email <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>email\n    state<span class=\"token punctuation\">.</span>avatar <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>avatar\n    state<span class=\"token punctuation\">.</span>likes_count <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>likes_count\n    state<span class=\"token punctuation\">.</span>goings_count <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>goings_count\n    state<span class=\"token punctuation\">.</span>past_count <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>past_count\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">,</span>\n  actions<span class=\"token punctuation\">,</span>\n  mutations<span class=\"token punctuation\">,</span>\n  namespaced<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"vue 全家桶初探","date":"June 15, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/vue_technology_stack/","previous":{"fields":{"slug":"/post/learn_react16_part4/"},"frontmatter":{"title":"react 16学习(四)"}},"next":{"fields":{"slug":"/post/process_of_webpack_build_project/"},"frontmatter":{"title":"webpack构建常见流程"}}}}