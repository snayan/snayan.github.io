{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三羊的小站","author":"三羊","postPath":"/post","contentUrl":"https://github.com/snayan/blog-source/tree/master/content/blog","menu":{"search":{"name":"搜索","link":"/search"}}}},"markdownRemark":{"id":"ece5b7c1-bfae-555c-8c18-3c1938669b60","excerpt":"React 中比较重要的就是React elements了，可以理解为页面中可看到的节点元素。一个React element的结构为下面这样，\n可以看到比较重要的几个属性：$$typeof，key，props，ref，type。$$typeof：固定为，在验证React element时就是取的这个值。key…","html":"<p>React 中比较重要的就是<strong>React elements</strong>了，可以理解为页面中可看到的节点元素。</p>\n\n        <h2 id='toc-2-1' >\n          结构\n        </h2>\n      \n<p>一个<strong>React element</strong>的结构为下面这样，\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f621474fee94664bcdbb6718dcd1081d/1bf5c/react_element.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 27.232142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAD/8QAFRABAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABgQAAIDAAAAAAAAAAAAAAAAAAABEBEh/9oACAEBAAE/IUtFR//aAAwDAQACAAMAAAAQc8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABABExUf/aAAgBAQABPxAUEO7Y8sv/2Q=='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/f621474fee94664bcdbb6718dcd1081d/cc182/react_element.webp 148w,\n/static/f621474fee94664bcdbb6718dcd1081d/f7e40/react_element.webp 295w,\n/static/f621474fee94664bcdbb6718dcd1081d/1a2f4/react_element.webp 590w,\n/static/f621474fee94664bcdbb6718dcd1081d/4837b/react_element.webp 885w,\n/static/f621474fee94664bcdbb6718dcd1081d/2f819/react_element.webp 1180w,\n/static/f621474fee94664bcdbb6718dcd1081d/9f9b9/react_element.webp 1344w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/f621474fee94664bcdbb6718dcd1081d/8ee9c/react_element.jpg 148w,\n/static/f621474fee94664bcdbb6718dcd1081d/ebbe7/react_element.jpg 295w,\n/static/f621474fee94664bcdbb6718dcd1081d/c739e/react_element.jpg 590w,\n/static/f621474fee94664bcdbb6718dcd1081d/5413e/react_element.jpg 885w,\n/static/f621474fee94664bcdbb6718dcd1081d/4efde/react_element.jpg 1180w,\n/static/f621474fee94664bcdbb6718dcd1081d/1bf5c/react_element.jpg 1344w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/f621474fee94664bcdbb6718dcd1081d/c739e/react_element.jpg\"\n          alt=\"react element\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<!--more-->\n<p>可以看到比较重要的几个属性：<strong>$$typeof</strong>，<strong>key</strong>，<strong>props</strong>，<strong>ref</strong>，<strong>type</strong>。</p>\n<ul>\n<li>$$typeof：固定为<code class=\"language-text\">Symbol(react.element)</code>，在验证React element时就是取的这个值。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">isValidElement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">object</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> object <span class=\"token operator\">===</span> <span class=\"token string\">\"object\"</span> <span class=\"token operator\">&amp;&amp;</span>\n    object <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span>\n    object<span class=\"token punctuation\">.</span>$$<span class=\"token keyword\">typeof</span> <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_ELEMENT_TYPE</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>key：在循环输出 React elements 时加上 key 属性，可以极大的优化性能，react 在进行节点”diff”比较时，会取 key 值进行比较。</li>\n<li>props：传递给 element 的属性对象，也包含了当前元素的子节点<code class=\"language-text\">children</code></li>\n</ul>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b8204a562291346a8c4f6bac82f1a7da/0626d/element_prop.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 14.06896551724138%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdyQsD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAx/9oACAEBAAE/IYsP/9oADAMBAAIAAwAAABB0D//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQABBQEAAAAAAAAAAAAAAAEhABARMYGR/9oACAEBAAE/EAlwpLprr7a//9k='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/b8204a562291346a8c4f6bac82f1a7da/cc182/element_prop.webp 148w,\n/static/b8204a562291346a8c4f6bac82f1a7da/f7e40/element_prop.webp 295w,\n/static/b8204a562291346a8c4f6bac82f1a7da/1a2f4/element_prop.webp 590w,\n/static/b8204a562291346a8c4f6bac82f1a7da/4837b/element_prop.webp 885w,\n/static/b8204a562291346a8c4f6bac82f1a7da/2f819/element_prop.webp 1180w,\n/static/b8204a562291346a8c4f6bac82f1a7da/d0ccc/element_prop.webp 1450w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b8204a562291346a8c4f6bac82f1a7da/8ee9c/element_prop.jpg 148w,\n/static/b8204a562291346a8c4f6bac82f1a7da/ebbe7/element_prop.jpg 295w,\n/static/b8204a562291346a8c4f6bac82f1a7da/c739e/element_prop.jpg 590w,\n/static/b8204a562291346a8c4f6bac82f1a7da/5413e/element_prop.jpg 885w,\n/static/b8204a562291346a8c4f6bac82f1a7da/4efde/element_prop.jpg 1180w,\n/static/b8204a562291346a8c4f6bac82f1a7da/0626d/element_prop.jpg 1450w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/b8204a562291346a8c4f6bac82f1a7da/c739e/element_prop.jpg\"\n          alt=\"element prop\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<ul>\n<li>ref：保存了对应真实 dom 的节点的访问的名称</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ref</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> refs <span class=\"token operator\">=</span> inst<span class=\"token punctuation\">.</span>refs <span class=\"token operator\">===</span> emptyObject <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>inst<span class=\"token punctuation\">.</span>refs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> inst<span class=\"token punctuation\">.</span>refs\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">delete</span> refs<span class=\"token punctuation\">[</span>stringRef<span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    refs<span class=\"token punctuation\">[</span>stringRef<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>type：当前元素的类型，取值为 html 元素，自定义组件，Fragment，StrictMode，AsyncMode。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">isValidElementType</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">:</span> mixed</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">\"string\"</span> <span class=\"token operator\">||</span>\n    <span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">\"function\"</span> <span class=\"token operator\">||</span>\n    <span class=\"token comment\">// Note: its typeof might be other than 'symbol' or 'number' if it's a polyfill.</span>\n    type <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_FRAGMENT_TYPE</span> <span class=\"token operator\">||</span>\n    type <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_ASYNC_MODE_TYPE</span> <span class=\"token operator\">||</span>\n    type <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_STRICT_MODE_TYPE</span> <span class=\"token operator\">||</span>\n    <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">\"object\"</span> <span class=\"token operator\">&amp;&amp;</span>\n      type <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span>\n      <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">.</span>$$<span class=\"token keyword\">typeof</span> <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_PROVIDER_TYPE</span> <span class=\"token operator\">||</span>\n        type<span class=\"token punctuation\">.</span>$$<span class=\"token keyword\">typeof</span> <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_CONTEXT_TYPE</span> <span class=\"token operator\">||</span>\n        type<span class=\"token punctuation\">.</span>$$<span class=\"token keyword\">typeof</span> <span class=\"token operator\">===</span> <span class=\"token constant\">REACT_FORWARD_REF_TYPE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n        <h2 id='toc-2-2' >\n          源码分析\n        </h2>\n      \n<p><strong>React elements</strong>是通过<code class=\"language-text\">React.createElement</code>函数创建的，可以创建内部预定义的元素类型，这些预定义的就是对应 html 中的原始 tagName（定义在 validateDOMNesting.js 文件中），也可以创建自定义组件的元素类型。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">,</span> children</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> propName\n\n  <span class=\"token comment\">// Reserved names are extracted</span>\n  <span class=\"token keyword\">const</span> props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">let</span> key <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">let</span> ref <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">let</span> self <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">let</span> source <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>config <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">hasValidRef</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      ref <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>ref\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">hasValidKey</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      key <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">+</span> config<span class=\"token punctuation\">.</span>key\n    <span class=\"token punctuation\">}</span>\n\n    self <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>__self <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">:</span> config<span class=\"token punctuation\">.</span>__self\n    source <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>__source <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">:</span> config<span class=\"token punctuation\">.</span>__source\n    <span class=\"token comment\">// Remaining properties are added to a new props object</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>propName <span class=\"token keyword\">in</span> config<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">,</span> propName<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n        <span class=\"token operator\">!</span><span class=\"token constant\">RESERVED_PROPS</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> config<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Children can be more than one argument, and those are transferred onto</span>\n  <span class=\"token comment\">// the newly allocated props object.</span>\n  <span class=\"token keyword\">const</span> childrenLength <span class=\"token operator\">=</span> arguments<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">2</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>childrenLength <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">=</span> children\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>childrenLength <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> childArray <span class=\"token operator\">=</span> <span class=\"token function\">Array</span><span class=\"token punctuation\">(</span>childrenLength<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> childrenLength<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      childArray<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arguments<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">=</span> childArray\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Resolve default props</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>type <span class=\"token operator\">&amp;&amp;</span> type<span class=\"token punctuation\">.</span>defaultProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> defaultProps <span class=\"token operator\">=</span> type<span class=\"token punctuation\">.</span>defaultProps\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>propName <span class=\"token keyword\">in</span> defaultProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> defaultProps<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    $$<span class=\"token keyword\">typeof</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">REACT_ELEMENT_TYPE</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">,</span>\n    key<span class=\"token punctuation\">,</span>\n    ref<span class=\"token punctuation\">,</span>\n    props<span class=\"token punctuation\">,</span>\n    _owner<span class=\"token punctuation\">:</span> owner<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n        <h2 id='toc-2-3' >\n          JSX\n        </h2>\n      \n<p>在创建<strong>React elements</strong>时，用<code class=\"language-text\">React.createElement</code>完全可以满足任何场景，并且 javascript 函数式编程的极大体现，极大的灵活。但是呢，在一些结构复杂，且嵌套层级多的结构中，我们使用<code class=\"language-text\">React.createElement</code>写会觉得比较繁琐，并且直观上不容易理解元素的结构。于是，<code class=\"language-text\">JSX</code>应运而生，用写 html 的方式写 React elements 的结构。实际背后是 babel，会把<code class=\"language-text\">JSX</code>转换为<code class=\"language-text\">React.createElement</code>的方式。详见：<a href=\"https://babeljs.io/docs/plugins/transform-react-jsx\">transform-react-jsx</a></p>","tableOfContents":"<ul><li><a href=\"#toc-2-1\">结构</a></li><li><a href=\"#toc-2-2\">源码分析</a></li><li><a href=\"#toc-2-3\">JSX</a></li></ul>","frontmatter":{"title":"react 16学习(四)","date":"April 11, 2018","tags":["react"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/learn_react16_part4/","previous":{"fields":{"slug":"/post/learn_react16_part3/"},"frontmatter":{"title":"react 16学习(三)"}},"next":{"fields":{"slug":"/post/vue_technology_stack/"},"frontmatter":{"title":"vue 全家桶初探"}}}}