{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"ä¸‰ç¾Šçš„å°ç«™","author":"ä¸‰ç¾Š","postPath":"/post","contentUrl":"https://github.com/snayan/blog-source/tree/master/content/blog","menu":{"search":{"name":"æœç´¢","link":"/search"}}}},"markdownRemark":{"id":"61acb6ff-a555-56b4-b3c2-56bfe6db2f18","excerpt":"æœ€è¿‘æƒ³äº†è§£ä¸€ä¸‹ React å’Œ Vue æ¡†æ¶åˆ†åˆ«åœ¨ virtual dom éƒ¨åˆ†çš„å®ç°ï¼Œä»¥åŠä»–ä»¬çš„ä¸åŒä¹‹å¤„ã€‚äºæ˜¯å…ˆç¿»å¼€ Vue çš„æºç å»æ‰¾ virtual dom çš„å®ç°ï¼Œçœ‹åˆ°å¼€å¤´ï¼Œå®ƒå°±æåˆ°äº† Vue çš„ virtual dom æ›´æ–°ç®—æ³•æ˜¯åŸºäº Snabbdom å®ç°çš„ã€‚äºæ˜¯ï¼Œåˆå»å…‹éš†äº† Snabbdomâ€¦","html":"<p>æœ€è¿‘æƒ³äº†è§£ä¸€ä¸‹ React å’Œ Vue æ¡†æ¶åˆ†åˆ«åœ¨ virtual dom éƒ¨åˆ†çš„å®ç°ï¼Œä»¥åŠä»–ä»¬çš„ä¸åŒä¹‹å¤„ã€‚äºæ˜¯å…ˆç¿»å¼€ Vue çš„æºç å»æ‰¾ virtual dom çš„å®ç°ï¼Œçœ‹åˆ°å¼€å¤´ï¼Œå®ƒå°±æåˆ°äº† Vue çš„ virtual dom æ›´æ–°ç®—æ³•æ˜¯åŸºäº Snabbdom å®ç°çš„ã€‚äºæ˜¯ï¼Œåˆå»å…‹éš†äº† Snabbdom çš„æºç ï¼Œå‘ç°å®ƒçš„æºç å¹¶ä¸æ˜¯å¾ˆå¤æ‚å¹¶ä¸”æ˜Ÿæ˜Ÿ ğŸŒŸ è¿˜å¾ˆå¤šï¼Œæ‰€ä»¥å°±ä»”ç»†çœ‹äº†ä¸€éäº†ï¼Œè¿™é‡Œå°±å°†è¯¦ç»†å­¦ä¹ ä¸€ä¸‹å®ƒæ˜¯å¦‚ä½•å®ç° virtual dom çš„ã€‚</p>\n<p>åœ¨ Snabbdom çš„ GitHub ä¸Šå°±è§£é‡Šäº†ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®ç° virtual dom çš„åº“ï¼Œç®€å•åŒ–ï¼Œæ¨¡å—åŒ–ï¼Œä»¥åŠå¼ºå¤§çš„ç‰¹æ€§å’Œæ€§èƒ½ã€‚</p>\n<blockquote>\n<p>A virtual DOM library with focus on simplicity, modularity, powerful features and performance.</p>\n</blockquote>\n<p><a href=\"https://github.com/snabbdom/snabbdom\">è¿™é‡Œæ˜¯ Snabbdom çš„ä»“åº“åœ°å€</a>ã€‚</p>\n\n          <h3 id='toc-3-1' >\n            init\n          </h3>\n        \n<!--more-->\n<p>Snabbdom çš„ç®€å•æ˜¯åŸºäºå®ƒçš„æ¨¡å—åŒ–ï¼Œå®ƒå¯¹ virtual dom çš„è®¾è®¡éå¸¸å·§å¦™ï¼Œåœ¨æ ¸å¿ƒé€»è¾‘ä¸­åªä¼šä¸“æ³¨äº vNode çš„æ›´æ–°ç®—æ³•è®¡ç®—ï¼Œè€ŒæŠŠæ¯ä¸ªèŠ‚ç‚¹å…·ä½“è¦æ›´æ–°çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚<code>props</code>ï¼Œ<code>class</code>ï¼Œ<code>styles</code>ï¼Œ<code>datalist</code>ç­‰æ”¾åœ¨ç‹¬ç«‹çš„æ¨¡å—é‡Œï¼Œé€šè¿‡åœ¨ä¸åŒæ—¶æœºè§¦å‘ä¸åŒ module çš„é’©å­å‡½æ•°å»å®Œæˆã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼è§£è€¦ï¼Œä¸ä»…å¯ä»¥ä½¿ä»£ç ç»„ç»‡ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œæ›´å¯ä»¥ä½¿å¾—æ¯ä¸€éƒ¨åˆ†éƒ½ä¸“æ³¨äºå®ç°ç‰¹å®šçš„åŠŸèƒ½ï¼Œåœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼Œè¿™ä¸ªä¹Ÿå«åšå•ä¸€èŒè´£åŸåˆ™ã€‚åœ¨å®é™…åœºæ™¯ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åªå¼•å…¥éœ€è¦ç”¨åˆ°çš„ç‰¹å®šæ¨¡å—ã€‚æ¯”å¦‚æˆ‘ä»¬åªä¼šæ›´æ–°èŠ‚ç‚¹çš„ç±»åå’Œæ ·å¼ï¼Œè€Œä¸å…³å¿ƒå±æ€§ä»¥åŠäº‹ä»¶ï¼Œé‚£ä¹ˆå°±åªéœ€è¦å¼•ç”¨ class å’Œ style çš„æ¨¡å—å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼Œ</p>\n<pre><code class=\"language-javascript\">// è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç”¨åˆ°classå’Œstyleæ¨¡å—ï¼Œæ‰€ä»¥å°±å¯ä»¥åªéœ€è¦å¼•ç”¨è¿™2ä¸ªæ¨¡å—\nvar patch = snabbdom.init([\n  require(\"snabbdom/modules/class\").default,\n  require(\"snabbdom/modules/style\").default,\n])\n</code></pre>\n<p>å®ƒçš„æ ¸å¿ƒæ–¹æ³•å°±æ˜¯è¿™ä¸ª<code>init</code>ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„å®ç°ï¼Œ</p>\n<pre><code class=\"language-typescript\">// è¿™é‡Œæ˜¯moduleä¸­çš„é’©å­å‡½æ•°\nconst hooks = [\"create\", \"update\", \"remove\", \"destroy\", \"pre\", \"post\"]\nexport function init(modules: Array&#x3C;Partial&#x3C;Module>>, domApi?: DOMAPI) {\n  let i: number,\n    j: number,\n    cbs = {} as ModuleHooks\n  const api: DOMAPI = domApi !== undefined ? domApi : htmlDomApi\n  // cbså­˜å‚¨äº†å¼•å…¥çš„modulesä¸­å®šä¹‰çš„é’©å­å‡½æ•°ï¼Œ\n  for (i = 0; i &#x3C; hooks.length; ++i) {\n    cbs[hooks[i]] = []\n    for (j = 0; j &#x3C; modules.length; ++j) {\n      const hook = modules[j][hooks[i]]\n      if (hook !== undefined) {\n        cbs[hooks[i]].push(hook)\n      }\n    }\n  }\n\n  // è¿˜å®šä¹‰äº†ä¸€äº›å…¶ä»–çš„å†…éƒ¨æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯æœåŠ¡äºpatch\n  function emptyNodeAt() {\n    /* ... */\n  }\n  function createRmCb() {\n    /* ... */\n  }\n  function createElm() {\n    /* ... */\n  }\n  function addVnodes() {\n    /* ... */\n  }\n  function invokeDestroyHook() {\n    /* ... */\n  }\n  function removeVnodes() {\n    /* ... */\n  }\n  function updateChildren() {\n    /* ... */\n  }\n  function patchVnode() {\n    /* ... */\n  }\n\n  // initè¿”å›äº†ä¸€ä¸ªpatchå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å°†è¢«æ›´æ–°çš„vNodeæˆ–è€…çœŸå®domèŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªæ˜¯ç”¨æ¥æ›´æ–°çš„æ–°çš„vNode\n  return function patch(oldVnode: VNode | Element, vnode: VNode): VNode {\n    //...\n  }\n}\n</code></pre>\n<p>ä»<code>init</code>å‡½æ•°æ•´ä½“æ¥çœ‹ï¼Œå®ƒæ¥å—ä¸€ä¸ª modules æ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°<code>patch</code>ã€‚è¿™ä¸å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„é—­åŒ…å‡½æ•°å—ï¼Ÿåœ¨<code>init</code>ä¸­ï¼Œå®ƒä¼šå°†å¼•å…¥æ¨¡å—çš„é’©å­å‡½æ•°é€šè¿‡éå†å­˜å‚¨åœ¨<code>cbs</code>å˜é‡é‡Œï¼Œåé¢åœ¨æ‰§è¡Œæ›´æ–°ç®—æ³•æ—¶ä¼šç›¸åº”çš„è§¦å‘è¿™äº›é’©å­å‡½æ•°ã€‚åªéœ€è¦åˆå§‹åŒ–ä¸€æ¬¡ï¼Œåé¢ virtual dom çš„æ›´æ–°éƒ½æ˜¯é€šè¿‡<code>patch</code>æ¥å®Œæˆçš„ã€‚</p>\n<p>æµç¨‹å›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./main.png\" alt=\"main\"></p>\n\n          <h3 id='toc-3-2' >\n            patch\n          </h3>\n        \n<p>æœ€ä¸ºå¤æ‚ä¹Ÿæœ€ä¸ºè€—æ—¶çš„éƒ¨åˆ†å°±æ˜¯å¦‚ä½•å®ç° virtual dom çš„æ›´æ–°ï¼Œæ›´æ–°ç®—æ³•çš„å¥½åç›´æ¥å½±å“æ•´ä¸ªæ¡†æ¶çš„æ€§èƒ½ï¼Œæ¯”å¦‚ React ä¸­çš„ react-reconciler æ¨¡å—ï¼Œåˆ° vue ä¸­çš„ vdom æ¨¡å—ï¼Œéƒ½æ˜¯æœ€å¤§å¯èƒ½ä¼˜åŒ–è¿™ä¸€éƒ¨åˆ†ã€‚åœ¨ Snabbdom ä¸­ virtual dom çš„æ›´æ–°é€»è¾‘å¤§è‡´å¦‚ä¸‹ï¼Œ</p>\n<pre><code class=\"language-typescript\">// è¿™ä¸ªpatchå°±æ˜¯initè¿”å›çš„\nfunction patch(oldVnode, vnode) {\n  // ç¬¬ä¸€æ­¥ï¼šå¦‚æœoldVnodeæ˜¯Elementï¼Œåˆ™æ ¹æ®Elementåˆ›å»ºä¸€ä¸ªç©ºçš„vnodeï¼Œè¿™ä¸ªä¹Ÿæ˜¯vnode treeçš„æ ¹èŠ‚ç‚¹\n  if (!isVnode(oldVnode)) {\n    oldVnode = emptyAtNode(oldVnode)\n  }\n  // ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­oldVnodeæ˜¯å¦ä¸vnodeç›¸åŒçš„å…ƒç´ ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ›´æ–°å…ƒç´ å³å¯ã€‚\n  // è¿™é‡Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦ç›¸åŒï¼Œæ˜¯å¯¹æ¯”äº†å®ƒä»¬çš„keyç›¸åŒä¸”tagNameç›¸åŒä¸”IDå±æ€§ç›¸åŒä¸”ç±»ç›¸åŒ\n  if (sameVnode(oldVnode, vnode)) {\n    patchVnode(oldVnode, vnode)\n  } else {\n    // ç¬¬ä¸‰æ­¥ï¼šå¦‚æœä¸ç›¸åŒï¼Œåˆ™ç›´æ¥ç”¨vnodeåˆ›å»ºæ–°çš„elementå…ƒç´ æ›¿æ¢oldVnodeï¼Œä¸”åˆ é™¤æ‰oldVnodeã€‚\n    elm = oldVnode.elm\n    parent = api.parentNode(elm)\n    createElm(vnode)\n    if (parent !== null) {\n      api.insertBefore(parent, vnode.elm, api.nextSlibing(elm))\n      removeVnodes(parent, [oldVnode], 0, 0)\n    }\n  }\n}\n</code></pre>\n<p><code>patch</code>é€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºä¸‹é¢ï¼š</p>\n<ol>\n<li>å¦‚æœ oldVnode æ˜¯ Element ç±»å‹ï¼Œåˆ™æ ¹æ® oldVnode åˆ›å»ºä¸€ä¸ªç©º vnodeï¼Œè¿™ä¸ªç©º vnode ä¹Ÿæ˜¯è¿™ä¸ª vnode tree çš„ root èŠ‚ç‚¹</li>\n<li>æ¯”è¾ƒ oldVnode ä¸ vnodeï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ª vnodeï¼ˆkey å€¼ç›¸åŒï¼‰æˆ–è€…æ˜¯ç›¸åŒç±»å‹çš„å…ƒç´ ï¼ˆtagName ç›¸åŒä¸” id ç›¸åŒä¸” class ç›¸åŒï¼‰ï¼Œåˆ™ç›´æ¥è°ƒç”¨<code>patchVnode</code></li>\n<li>å¦åˆ™ï¼Œç›´æ¥æ ¹æ® vnode åˆ›å»ºä¸€ä¸ªæ–°çš„ elementï¼Œä¸”ç”¨æ–°çš„ element æ›¿æ¢æ‰ oldVnode çš„ elementï¼Œä¸”åˆ é™¤æ‰ oldVnode</li>\n</ol>\n<p>æµç¨‹å›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./structure.png\" alt=\"structure\"></p>\n<p>åœ¨è¿›è¡Œç¬¬ 3 æ­¥æ—¶ï¼Œå½“ oldVnode ä¸ vnode ä¸ç›¸åŒï¼Œæ˜¯ç›´æ¥æŠ›å¼ƒäº†æ—§çš„èŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°çš„èŠ‚ç‚¹æ¥æ›¿æ¢ï¼Œåœ¨ç”¨æ–° vnode æ¥åˆ›å»ºèŠ‚ç‚¹æ—¶ä¼šæ£€æŸ¥å½“å‰ vnode æœ‰æ²¡æœ‰ childrenï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¹Ÿä¼šéå† children åˆ›å»ºå‡ºæ–°çš„ elementã€‚è¿™æ„å‘³ oldVnode ä»¥åŠåŒ…å«çš„æ‰€æœ‰å­èŠ‚ç‚¹å°†è¢«ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ–°çš„ vnode æ›¿æ¢ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./replace.png\" alt=\"replace\"></p>\n<p>å¦‚æœ B ä¸ B'ä¸ç›¸åŒï¼Œåˆ™ B åœ¨è¢« B'æ›¿æ¢çš„è¿‡ç¨‹ä¸­ï¼ŒB çš„å­èŠ‚ç‚¹ D ä¹Ÿå°±è¢« B'çš„å­èŠ‚ç‚¹ D'å’Œ E'ä¸€èµ·æ›¿æ¢æ‰äº†ã€‚</p>\n\n          <h3 id='toc-3-3' >\n            patchVnode\n          </h3>\n        \n<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ç¬¬ 2 æ­¥ï¼Œå¦‚æœ oldVnode ä¸ vnode ç›¸åŒï¼Œåˆ™ä¼šå¤ç”¨ä¹‹å‰å·²ç»åˆ›å»ºå¥½çš„ domï¼Œåªæ˜¯æ›´æ–°è¿™ä¸ª dom ä¸Šçš„å·®å¼‚ç‚¹ï¼Œæ¯”å¦‚ textï¼Œclassï¼Œdatalistï¼Œstyle ç­‰ã€‚è¿™ä¸ªæ˜¯åœ¨å‡½æ•°<code>patchVnode</code>ä¸­å®ç°çš„ï¼Œä¸‹é¢ä¸ºå®ƒçš„å¤§è‡´é€»è¾‘ï¼Œ</p>\n<pre><code class=\"language-typescript\">function patchVnode(oldVnode, vnode) {\n   // è·å–oldVnodeçš„domå¯¹è±¡\n  const elm = oldVnode.elm\n  // å°†vnodeçš„elmç›´æ¥æŒ‡å‘elmï¼Œå¤ç”¨oldVnodeçš„domå¯¹è±¡ï¼Œå› ä¸ºå®ƒä»¬ç±»å‹ç›¸åŒ\n  vnode.elm = elm\n  // å¦‚æœoldVnodeä¸vnodeç›¸ç­‰ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œæ ¹æœ¬ä¸ç”¨æ›´æ–°äº†\n  if (oldVnode === vnode) {\n    return\n  }\n  // å¦‚æœvnodeæ˜¯åŒ…å«textï¼Œä¸”ä¸ç­‰äºoldVnode.textï¼Œåˆ™ç›´æ¥æ›´æ–°elmçš„textContentä¸ºvnode.text\n  if (isDef(vnode.text) &#x26;&#x26; vnode.text !== oldVnode.text) {\n    return api.setTextContext(elm, vnode.text)\n  }\n  let oldCh = oldVnode.children // è·å–oldVnodeçš„å­èŠ‚ç‚¹\n  let ch = vnode.children // è·å–vnodeçš„å­èŠ‚ç‚¹\n\n  // å¦‚æœoldVnodeæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œè€Œvnodeæœ‰å­èŠ‚ç‚¹,åˆ™æ·»åŠ vnodeçš„å­èŠ‚ç‚¹\n  if (isUndef(oldCh) &#x26;&#x26; isDef(ch)) {\n    // å¦‚æœoldVnodeæœ‰textå€¼ï¼Œåˆ™å…ˆå°†elmçš„textContentæ¸…ç©º\n    if (idDef(oldVnode.text)) {\n      api.setTextContext(elm, \"\")\n    }\n    addVnodes(elm, null, ch, 0, ch.length - 1)\n  }\n  // å¦‚æœoldVnodeæœ‰å­èŠ‚ç‚¹ï¼Œè€Œvnodeæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™åˆ é™¤oldVnodeçš„å­èŠ‚ç‚¹\n  else if (isUndef(ch) &#x26;&#x26; isDef(oldCh)) {\n    reoveVnodes(elm, oldCh, 0, oldCh.length - 1)\n  }\n  // å¦‚æœå®ƒä»¬éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”å­èŠ‚ç‚¹ä¸ç›¸åŒï¼Œåˆ™æ›´æ–°å®ƒä»¬çš„å­èŠ‚ç‚¹\n  else if (ch !== oldCh) {\n    updateChildren(elm, oldCh, ch)\n  }\n  // å¦åˆ™å°±æ˜¯å®ƒä»¬éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œä¸”å­èŠ‚ç‚¹ç›¸åŒï¼Œå¦‚æœoldVnodeæœ‰textå€¼ï¼Œåˆ™å°†elmçš„textContentæ¸…ç©º\n  else if (ifDef(oldVnode.text)) {\n    api.setTextContext(elm, \"\")\n  }\n}\n</code></pre>\n<p><code>patchVnode</code>é€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºä¸‹é¢ï¼š</p>\n<ol>\n<li>ç›´æ¥å°† vnode çš„ elm è®¾ç½®ä¸º oldVnode çš„ elmï¼Œä»¥è¾¾åˆ°å¤ç”¨å·²æœ‰çš„ dom å¯¹è±¡ï¼Œé¿å…äº†åˆ›å»ºæ–°çš„ dom å¯¹è±¡çš„å¼€é”€</li>\n<li>æ¯”è¾ƒ oldVnode === vnodeï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œä¸åŒæ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡</li>\n<li>å¦‚æœ vnode æœ‰ text å€¼ï¼Œåˆ™è¯´æ˜ elm å°±åªåŒ…å«äº†çº¯ text æ–‡æœ¬ï¼Œæ— å…¶ä»–ç±»å‹å­èŠ‚ç‚¹ï¼Œå¦‚æœå®ƒçš„å€¼ä¸ oldVnode çš„ text ä¸ç›¸åŒï¼Œåˆ™æ›´æ–° elm çš„ textContentï¼Œå¹¶è¿”å›ã€‚</li>\n<li>è¿™ä¸€æ­¥å¼€å§‹ï¼ŒçœŸæ­£æ¯”è¾ƒå®ƒä»¬çš„ children äº†ï¼Œ<ul>\n<li>å¦‚æœ vnode æœ‰ childrenï¼ŒoldVnode æ²¡æœ‰ childrenï¼Œå…ˆæ¸…ç©º elm çš„ textContextï¼Œå†å°† vnode çš„ children æ·»åŠ è¿›æ¥</li>\n<li>å¦‚æœ vnode æ²¡æœ‰ childrenï¼ŒoldVnode æœ‰ childrenï¼Œåˆ™ç›´æ¥åˆ é™¤ oldVnode çš„ children</li>\n<li>å¦‚æœå®ƒä»¬éƒ½æœ‰ childrenï¼Œä¸”ä¸ç›¸åŒï¼Œåˆ™æ›´æ–°å®ƒä»¬çš„ children</li>\n<li>å¦‚æœå®ƒä»¬éƒ½æœ‰ childrenï¼Œä¸”ç›¸åŒï¼Œåˆ™æ¸…ç©º elm çš„ textContext</li>\n</ul></li>\n</ol>\n<p>æµç¨‹å›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./patchVnode.png\" alt=\"patchVnode\"></p>\n<p>åœ¨<code>patchVnode</code>æ›´æ–°æ—¶ï¼Œvnode ä¼šå…ˆæ˜¯é€šè¿‡è§¦å‘å®šä¹‰åœ¨ data æ•°æ®ä¸Šçš„é’©å­å‡½æ•°æ¥æ›´æ–°è‡ªå·±èŠ‚ç‚¹ä¸Šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚ class æˆ–è€… styles ç­‰ï¼Œç„¶åå†å»æ›´æ–° children èŠ‚ç‚¹ä¿¡æ¯ã€‚</p>\n\n          <h3 id='toc-3-4' >\n            updateChildren\n          </h3>\n        \n<p>æ›´æ–° vnode.children ä¿¡æ¯æ˜¯é€šè¿‡<code>updateChildren</code>å‡½æ•°æ¥å®Œæˆçš„ã€‚åªæœ‰å½“ oldVnode ä¸Šå­˜åœ¨ childrenï¼Œä¸” vnode ä¸Šä¹Ÿå­˜åœ¨ children æ—¶ï¼Œå¹¶ä¸”<code>oldVnode.children !== vnode.children</code>æ—¶ï¼Œæ‰ä¼šå»è°ƒç”¨<code>updateChildren</code>ã€‚ä¸‹é¢æ¥æ¢³ç†ä¸€ä¸‹<code>updateChildren</code>çš„å¤§è‡´é€»è¾‘ï¼Œ</p>\n<pre><code class=\"language-typescript\">function updateChildren(parentElm, oldCh, newCh) {\n  // æ—§çš„children\n  let oldStartIdx = 0\n  let oldEndIdx = oldCh.length - 1\n  let oldStartVnode = oldCh[oldStartIdx]\n  let oldEndVnode = oldCh(oldEndIdx)\n\n  // æ–°çš„children\n  let newStartIdx = 0\n  let newEndIdx = newCh.length - 1\n  let newStartVnode = newCh(newStartIdx)\n  let newEndVnode = newCh(newEndIdx)\n\n  let before = null\n\n  // å¾ªç¯æ¯”è¾ƒ\n  while (oldStartIdx &#x3C;= oldEndIdx &#x26;&#x26; newStartIdx &#x3C;= newEndIdx) {\n    if (oldStartVnode == null) {\n      // å½“å‰èŠ‚ç‚¹å¯èƒ½è¢«ç§»åŠ¨äº†\n      oldStartVnode = oldCh[++oldStartIdx]\n    } else if (oldEndVnode == null) {\n      oldEndVnode = oldCh[--oldEndIdx]\n    } else if (newStartVnode == null) {\n      newStartVnode = newCh[++newStartIdx]\n    } else if (newEndVnode == null) {\n      newEndVnode = newCh[--newEndIdx]\n    } else if (sameVnode(oldStartVnode, newStartVnode)) {\n      patchVnode(oldStartVnode, newStartVnode) // æ›´æ–°newStartVnode\n      oldStartVnode = oldCh[++oldStartIdx] // oldStartIdx å‘å³ç§»åŠ¨\n      newStartVnode = newCh[++newStartIdx] // newStartIdx å‘å³ç§»åŠ¨\n    } else if (sameVnode(oldEndVnode, newEndVnode)) {\n      patchVnode(oldEndVnode, newEndVnode) // æ›´æ–°newEndVnode\n      oldEndVnode = oldCh[--oldEndIdx] // oldEndIdx å‘å·¦ç§»åŠ¨\n      newEndVnode = newCh[--newEndIdx] // newEndIdx å‘å·¦ç§»åŠ¨\n    } else if (sameVnode(oldStartVnode, newEndVnode)) {\n      patchVnode(oldStartVnode, newEndVnode) //æ›´æ–°newEndVnode\n      let oldAfterVnode = api.nextSibling(oldEndVnode)\n      // å°†oldStartVnodeç§»åŠ¨åˆ°å½“å‰oldEndVnodeåé¢\n      api.insertBefore(parentElm, oldStartVnode.elm, oldAfterVnode)\n      oldStartVnode = oldCh[++oldStartIdx] // oldStartIdx å‘å³ç§»åŠ¨\n      newEndVnode = newCh[--newOldVnode] // newEndIdx å‘å·¦ç§»åŠ¨\n    } else if (sameVnode(oldEndVnode, newStartVnode)) {\n      patchVnode(oldEndVnode, newStartVnode) // æ›´æ–°newStartVnode\n      // å°†oldEndVnodeç§»åŠ¨åˆ°oldStartVnodeå‰é¢\n      api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm)\n      oldEndVnode = oldCh[--oldEndIdx] // oldEndVnode å‘å³ç§»åŠ¨\n      newStartVnode = newCh[++newStartIdx] // newStartVnode å‘å·¦ç§»åŠ¨\n    } else {\n      // è·å–å½“å‰æ—§çš„childrençš„èŠ‚ç‚¹çš„keyä¸å…¶indexçš„å¯¹åº”å€¼ï¼Œ\n      if (oldKeyIdx == undefined) {\n        oldKeyIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx)\n      }\n      // è·å–å½“å‰newStartVnodeçš„keyæ˜¯å¦å­˜åœ¨æ—§çš„childrenæ•°ç»„é‡Œ\n      idxInOld = oldKeyIdx[newStartVnode.key]\n      if (isUndef(idxInOld)) {\n        // å¦‚æœå½“å‰newStartVnodeçš„keyä¸å­˜åœ¨æ—§çš„childrenæ•°ç»„é‡Œï¼Œé‚£ä¹ˆè¿™ä¸ªnewStartVnodeå°±æ˜¯æ–°çš„ï¼Œéœ€è¦æ–°å»ºdom\n        let newDom = createElm(newStartVnode)\n        api.insertBefore(parentElm, newDom, oldStartVnode.elm)\n        newStartVnode = newCh[++newStartIdx]\n      } else {\n        // å¦åˆ™ï¼Œå½“å‰newStartVnodeçš„keyå­˜åœ¨æ—§çš„childrené‡Œï¼Œè¯´æ˜å®ƒä»¬ä¹‹å‰æ˜¯åŒä¸€ä¸ªVnode,\n        elmToMove = oldCh[idxInOld]\n        if (elmToMove.sel !== newStartVnode.sel) {\n          // èŠ‚ç‚¹ç±»å‹å˜äº†ï¼Œä¸æ˜¯åŒä¸€ä¸ªç±»å‹çš„domå…ƒç´ äº†,ä¹Ÿæ˜¯éœ€è¦æ–°å»ºçš„\n          let newDom = createElm(newStartVnode)\n          api.insertBefore(parentElm, newDom, oldStartVnode.elm)\n        } else {\n          // å¦åˆ™ï¼Œå®ƒä»¬æ˜¯åŒä¸€ä¸ªVnodeä¸”domå…ƒç´ ä¹Ÿç›¸åŒï¼Œåˆ™ä¸éœ€è¦æ–°å»ºï¼Œåªéœ€è¦æ›´æ–°å³å¯\n          patchVnode(elmToMove, newStartVnode)\n          oldCh[idxInOld] = undefined // æ ‡å¿—æ—§çš„childrenå½“å‰ä½ç½®çš„å…ƒç´ è¢«ç§»èµ°äº†ï¼Œ\n          api.insertBefore(parentElm, elmToMove, oldStartVnode.elm)\n        }\n        newStartVnode = newCh[++newStartIdx]\n      }\n    }\n  }\n\n  // å¦‚æœå¾ªç¯ä¹‹åï¼Œè¿˜æœ‰æœªå¤„ç†çš„childrenï¼Œ\n  if (oldStartIdx &#x3C;= oldEndIdx || newStartIdx &#x3C;= newEndIdx) {\n    // å¦‚æœæ–°çš„childrenè¿˜æœ‰éƒ¨åˆ†æœªå¤„ç†ï¼Œåˆ™æŠŠå¤šçš„éƒ¨åˆ†å¢åŠ è¿›å»\n    if (oldStartIdx > oldEndIdx) {\n      before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1]\n      addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx)\n    } else {\n      // å¦‚æœæ—§çš„childrenè¿˜æœ‰æœªå¤„ç†ï¼Œåˆ™æŠŠå¤šçš„éƒ¨åˆ†åˆ é™¤æ‰\n      removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx)\n    }\n  }\n}\n</code></pre>\n<p><code>updateChildren</code>å‡½æ•°é€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºï¼Œ</p>\n<ol>\n<li>åˆå§‹åŒ–å¾ªç¯å˜é‡</li>\n<li>æ ¹æ®å˜é‡å¾ªç¯éå† old children ä¸ new childrenï¼Œå¹¶é€ä¸ªæ¯”è¾ƒæ›´æ–°ï¼Œå½“ç±»å‹ç›¸åŒæ—¶ï¼Œåˆ™è°ƒç”¨<code>patchVnode</code>æ›´æ–°ï¼Œå½“ç±»å‹ä¸åŒæ—¶ï¼Œåˆ™ç›´æ¥æ–°å»º new vnode çš„ dom å…ƒç´ ï¼Œå¹¶æ’å…¥åˆ°åˆé€‚çš„ä½ç½®</li>\n<li>å¾ªç¯å®Œäº†ä¹‹åï¼Œå¢åŠ æ–°å¢çš„ new vnode èŠ‚ç‚¹å’Œç§»é™¤æ—§çš„å†—ä½™çš„ old vnode</li>\n</ol>\n<p>æµç¨‹å›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./updateChildren.png\" alt=\"updateChildren\"></p>\n<p>åœ¨<code>updateChildren</code>å‡½æ•°ä¸­ï¼Œé€ä¸ªæ›´æ–° children ä¸­èŠ‚ç‚¹æ—¶ï¼Œå½“æ¯”è¾ƒçš„ä¸¤ä¸ªèŠ‚ç‚¹ç±»å‹ç›¸åŒæ—¶ï¼Œåˆä¼šåè¿‡æ¥è°ƒç”¨<code>patchVnode</code>æ¥æ›´æ–°èŠ‚ç‚¹ï¼Œè¿™æ ·ï¼Œå®é™…ä¸Šå­˜åœ¨äº†é—´æ¥çš„é€’å½’è°ƒç”¨ã€‚</p>\n\n          <h3 id='toc-3-5' >\n            life cycle hooks\n          </h3>\n        \n<p>åœ¨ä½¿ç”¨ React æˆ–è€… Vue æ—¶ï¼Œä½ ä¼šå‘ç°å®ƒä»¬éƒ½åˆ†åˆ«å®šä¹‰äº†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè™½ç„¶åç§°æˆ–è§¦å‘æ—¶æœºä¸å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯åŸºæœ¬çš„é¡ºåºå’Œç›®çš„æ˜¯å·®ä¸å¤šçš„ã€‚Snabbdom ä¹Ÿæä¾›äº†ç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œä¸åŒçš„æ˜¯å®ƒæä¾›äº† 2 å¥—ï¼Œä¸€å¥—æ˜¯é’ˆå¯¹ virtual dom çš„ï¼Œæ¯”å¦‚ä¸€ä¸ª Vnode çš„<code>create</code>ï¼Œ<code>update</code>ï¼Œ<code>remove</code>ç­‰ï¼›ä¸€å¥—æ˜¯é’ˆå¯¹ modules çš„ï¼Œé€šè¿‡åœ¨ä¸åŒæ—¶æœºè§¦å‘ä¸åŒ module çš„é’©å­å‡½æ•°å»å®Œæˆå½“å‰ Vnode çš„æ›´æ–°æ“ä½œã€‚</p>\n<p>modules çš„ä¸Šçš„é’©å­å‡½æ•°å¦‚ä¸‹,</p>\n<pre><code class=\"language-typescript\">export interface Module {\n  pre: PreHook\n  create: CreateHook\n  update: UpdateHook\n  destroy: DestroyHook\n  remove: RemoveHook\n  post: PostHook\n}\n</code></pre>\n<p>å®ƒçš„è§¦å‘æ—¶æœºå›¾å¦‚ä¸‹ï¼Œ</p>\n<p><img src=\"./module_hooks.png\" alt=\"modules_hook\"></p>\n<p>åœ¨è§¦å‘ modules çš„ hooks å‡½æ•°æ—¶ï¼Œä¸åŒçš„å‡½æ•°ä¼šæ¥å—ä¸åŒçš„å‚æ•°ï¼Œä¸‹é¢ä¸º modukes ä¸­é’©å­å‡½æ•°æ¥å—å‚æ•°æƒ…å†µï¼Œ</p>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Triggered when</th>\n<th>Arguments to callback</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>pre</code></td>\n<td>åœ¨<code>patch</code>å‡½æ•°å¼€å§‹å¤„</td>\n<td>æ— </td>\n</tr>\n<tr>\n<td><code>create</code></td>\n<td>åœ¨<code>createElm</code>å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ª element æ—¶</td>\n<td><code>vnode</code></td>\n</tr>\n<tr>\n<td><code>update</code></td>\n<td>åœ¨<code>pathVnode</code>å‡½æ•°ä¸­æ›´æ–° Vnode æ—¶ï¼Œ</td>\n<td><code>oldVnode</code>ï¼Œ<code>newVnode</code></td>\n</tr>\n<tr>\n<td><code>destroy</code></td>\n<td>åœ¨<code>removeVnodes</code>å‡½æ•°ä¸­ç§»é™¤ Vnode æ—¶ï¼Œ</td>\n<td><code>vnode</code></td>\n</tr>\n<tr>\n<td><code>remove</code></td>\n<td>åœ¨<code>removeVnodes</code>å‡½æ•°ä¸­ç§»é™¤ Vnode æ—¶ï¼Œ</td>\n<td><code>vnode</code>ï¼Œ<code>removeCallback</code></td>\n</tr>\n<tr>\n<td><code>post</code></td>\n<td>åœ¨<code>patch</code>å‡½æ•°æœ€åå¤„ï¼Œ</td>\n<td>æ— </td>\n</tr>\n</tbody>\n</table>\n<p>å¤§éƒ¨åˆ† module ä¸­éƒ½æ²¡æœ‰å®šä¹‰<code>pre</code>å‡½æ•°å’Œ<code>post</code>å‡½æ•°ï¼Œä¸»è¦æ˜¯åœ¨<code>create</code>ï¼Œ<code>update</code>ï¼Œ <code>destory</code>ï¼Œ<code>remove</code>ä¸­å¯¹å½“å‰ Vnode è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚ï¼Œåœ¨ class module ä¸­åœ¨<code>create</code>å‡½æ•°å†…å¯¹ Vnode ä¸Šçš„æ“ä½œå¦‚ä¸‹ï¼Œ</p>\n<pre><code class=\"language-typescript\">// class modules ä¸­åœ¨createé’©å­å‡½æ•°ä¸­å¯¹å½“å‰Vnodeæ“ä½œ\nfunction updateClass(oldVnode: VNode, vnode: VNode): void {\n  var cur: any,\n    name: string,\n    elm: Element = vnode.elm as Element,\n    oldClass = (oldVnode.data as VNodeData).class, // æ—§çš„class\n    klass = (vnode.data as VNodeData).class // æ–°çš„class\n\n  if (!oldClass &#x26;&#x26; !klass) return // éƒ½ä¸å­˜åœ¨class,ç›´æ¥è¿”å›\n  if (oldClass === klass) return // ç›¸ç­‰ï¼Œç›´æ¥è¿”å›\n  oldClass = oldClass || {}\n  klass = klass || {}\n\n  // åˆ é™¤é‚£äº›å­˜åœ¨oldVnodeä¸Šè€Œä¸å­˜åœ¨vnodeä¸Šçš„\n  for (name in oldClass) {\n    if (!klass[name]) {\n      elm.classList.remove(name)\n    }\n  }\n  // éå†å½“å‰vnodeä¸Šçš„classï¼Œ\n  for (name in klass) {\n    cur = klass[name]\n    // å¦‚æœä¸æƒ³ç­‰\n    if (cur !== oldClass[name]) {\n      // å¦‚æœå€¼ä¸ºtrueï¼Œåˆ™æ·»åŠ classï¼Œå¦åˆ™ç§»é™¤class\n      ;(elm.classList as any)[cur ? \"add\" : \"remove\"](name)\n    }\n  }\n}\n</code></pre>\n<p>å…¶ä»– module çš„å…¶ä»– hook å‡½æ•°ä¹Ÿéƒ½ä¼šå¯¹å½“å‰ vnode æ›´æ–°ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>\n<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹å¯¹ Vnode ä¸Šçš„é’©å­å‡½æ•°å¦‚ä¸‹ï¼Œ</p>\n<pre><code class=\"language-typescript\">export interface Hooks {\n  init?: InitHook\n  create?: CreateHook\n  insert?: InsertHook\n  prepatch?: PrePatchHook\n  update?: UpdateHook\n  postpatch?: PostPatchHook\n  destroy?: DestroyHook\n  remove?: RemoveHook\n}\n</code></pre>\n<p>å®ƒçš„è§¦å‘æ—¶æœºä»¥åŠæ¥å—å‚æ•°æƒ…å†µå¦‚ä¸‹ï¼Œ</p>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Triggered when</th>\n<th>Arguments to callback</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>init</code></td>\n<td>åœ¨<code>createElm</code>æ—¶ä¼šå…ˆè§¦å‘<code>init</code></td>\n<td><code>vnode</code></td>\n</tr>\n<tr>\n<td><code>create</code></td>\n<td>åœ¨<code>createElm</code>æ—¶ï¼Œå·²ç»å»ºå¥½äº† elementï¼Œå·²ç»å¯¹åº”çš„ children éƒ½åˆ›å»ºå®Œæ¯•ï¼Œä¹‹ååœ¨è§¦å‘<code>create</code></td>\n<td><code>emptyVnode</code>ï¼Œ<code>vnode</code></td>\n</tr>\n<tr>\n<td><code>insert</code></td>\n<td>å½“<code>vnode.elm</code>å·²ç»æ›´æ–°åˆ° dom æ–‡æ¡£ä¸Šäº†ï¼Œæœ€ååœ¨<code>patch</code>å‡½æ•°ç»“å°¾å¤„è§¦å‘</td>\n<td><code>vnode</code></td>\n</tr>\n<tr>\n<td><code>prepatch</code></td>\n<td>åœ¨<code>patchVnode</code>å¼€å§‹å¤„å°±è§¦å‘äº†<code>prepatch</code></td>\n<td><code>oldVnode</code>ï¼Œ<code>vnode</code></td>\n</tr>\n<tr>\n<td><code>update</code></td>\n<td>åœ¨<code>patchVnode</code>ä¸­ï¼Œ<code>vnode.elm=oldVnode.elm</code>ä¹‹åï¼Œæ›´æ–° children ä¹‹å‰è§¦å‘</td>\n<td><code>oldVnode</code>ï¼Œ<code>vnode</code></td>\n</tr>\n<tr>\n<td><code>postpatch</code></td>\n<td>åœ¨<code>patchVnode</code>ä¸­ç»“å°¾å¤„ï¼Œå·²ç»æ›´æ–°ä¸º children åè§¦å‘ï¼Œ</td>\n<td><code>oldvnode</code>ï¼Œ<code>vnode</code></td>\n</tr>\n<tr>\n<td><code>destroy</code></td>\n<td>åœ¨<code>removeVnodes</code>ä¸­è§¦å‘ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰è¢«ç§»é™¤</td>\n<td><code>vnode</code></td>\n</tr>\n<tr>\n<td><code>remove</code></td>\n<td>åœ¨<code>removeVnodes</code>ä¸­ï¼Œ<code>destroy</code>ä¹‹åè§¦å‘ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰çœŸæ­£è¢«ç§»é™¤ï¼Œéœ€è°ƒç”¨<code>removeCallback</code>æ‰çœŸæ­£å°† element ç§»é™¤</td>\n<td><code>vnode</code>ï¼Œ<code>removeCallback</code></td>\n</tr>\n</tbody>\n</table>\n<p>åœ¨<code>Vnode</code>ä¸Šçš„é’©å­å‡½æ•°å°±æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„äº†ï¼Œå®šä¹‰åœ¨<code>data.hooks</code>ä¸­ï¼Œä¾‹å¦‚ï¼Œ</p>\n<pre><code class=\"language-typescript\">h(\"div.row\", {\n  key: movie.rank,\n  hook: {\n    insert: vnode => {\n      movie.elmHeight = vnode.elm.offsetHeight\n    },\n  },\n})\n</code></pre>\n\n          <h3 id='toc-3-6' >\n            å°ç»“\n          </h3>\n        \n<p>åœ¨çœ‹äº†æºç ä¹‹åï¼Œå…¶å®æœ€ä¸ºå¤æ‚çš„åœ°æ–¹å°±æ˜¯<code>updateChildren</code>ä¸­æ›´æ–°å­èŠ‚ç‚¹ï¼Œè¿™é‡Œä¸ºäº†é¿å…é‡å¤åˆ›å»º elementï¼Œè€Œåšäº†å¾ˆå¤šçš„åˆ¤æ–­å’Œæ¯”è¾ƒï¼Œä»¥è¾¾åˆ°æœ€å¤§åŒ–çš„å¤ç”¨ä¹‹å‰å·²ç»åˆ›å»ºå¥½çš„ elementã€‚ä¸ React å’Œ Vue ç±»ä¼¼ï¼Œå®ƒåœ¨æ¯”è¾ƒä¸­ä¹Ÿæ·»åŠ äº†<code>key</code>æ¥ä¼˜åŒ–è¿™ä¸€ç‚¹ã€‚åœ¨æ›´æ–° Vnode å¯¹åº”çš„ element æ—¶ï¼Œå®ƒå°†ä¸åŒæ•°æ®åˆ†è§£åˆ°ä¸åŒ module ä¸­å»æ›´æ–°ï¼Œé€šè¿‡é’©å­å‡½æ•°æ¥è§¦å‘ï¼Œè¿™ä¸€ç‚¹éå¸¸çš„ä¼˜é›…ã€‚</p>","tableOfContents":"<ul><li><a href=\"#toc-3-1\">init</a><ul></ul></li><li><a href=\"#toc-3-2\">patch</a><ul></ul></li><li><a href=\"#toc-3-3\">patchVnode</a><ul></ul></li><li><a href=\"#toc-3-4\">updateChildren</a><ul></ul></li><li><a href=\"#toc-3-5\">life cycle hooks</a><ul></ul></li><li><a href=\"#toc-3-6\">å°ç»“</a><ul></ul></li></ul>","frontmatter":{"title":"ç†è§£virtual domçš„å®ç°ç»†èŠ‚-snabbdom","date":"December 31, 2018","tags":["h5","vue","vdom"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/understand_the_details_of_vritual_dom_snabbdom/","previous":{"fields":{"slug":"/post/resolve_issue_of_using_audio/"},"frontmatter":{"title":"HTML5ä¸­Audioä½¿ç”¨è¸©å‘æ±‡æ€»"}},"next":{"fields":{"slug":"/post/understand_the_details_of_h5_and_native(ios)_communication/"},"frontmatter":{"title":"ç†è§£h5ä¸native(ios)é€šä¿¡ç»†èŠ‚"}}}}