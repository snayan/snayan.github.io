{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三羊的小站","author":"三羊","postPath":"/post","contentUrl":"https://github.com/snayan/blog-source/tree/master/content/blog","menu":{"search":{"name":"搜索","link":"/search"}}}},"markdownRemark":{"id":"843a710a-20aa-5681-a940-8c0302314124","excerpt":"在某次求职过程中，收到了一个笔试题，要求写一个人机对战的五子棋，题目要求如下：请编写一个单机【五子棋】游戏，要求如下：\n使用原生技术实现，兼容 Chrome 浏览器即可。\n实现胜负判断，并给出赢棋提示；任意玩家赢得棋局，锁定棋盘。\n请尽可能的考虑游戏的扩展性，界面可以使用 DOM / Canvas…","html":"<p>在某次求职过程中，收到了一个笔试题，要求写一个人机对战的五子棋，题目要求如下：</p>\n<blockquote>\n<p>请编写一个单机【五子棋】游戏，要求如下：\n使用原生技术实现，兼容 Chrome 浏览器即可。\n实现胜负判断，并给出赢棋提示；任意玩家赢得棋局，锁定棋盘。\n请尽可能的考虑游戏的扩展性，界面可以使用 DOM / Canvas 实现。考虑后续切换界面实现的方式成本最低。（比如选择使用 DOM 实现界面，需求改变为使用 Canvas 实现时尽可能少的改动代码）。\n实现一个悔棋功能\n实现一个撤销悔棋功能\n实现一个人机对战功能\n尽可能的考虑实现的灵活性和扩展性</p>\n</blockquote>\n<p>自己收到这个题目之后感觉有点棘手，自己没有开发过游戏，时间也比较紧。下班之后就开始弄了，简单介绍下自己的实现过程。</p>\n<!--more-->\n\n          <h3 id='toc-3-1' >\n            难点\n          </h3>\n        \n<ul>\n<li>机器人自动选择最佳可下棋子的位置</li>\n<li>判断是否胜利</li>\n</ul>\n\n          <h3 id='toc-3-2' >\n            思路\n          </h3>\n        \n<ul>\n<li>选择 dom 方式实现，采用坐标系方式计算每个格子的值，对 canvas 不是太熟悉。</li>\n<li>分离 dom 交互的部分，比如画棋盘，画棋子，悔棋等等。</li>\n<li>分离人机对战逻辑部分，比如计算可下区域的逻辑，胜利的逻辑，机器人选择最佳棋子的逻辑，悔棋逻辑，撤销悔棋逻辑等等。</li>\n</ul>\n\n          <h3 id='toc-3-3' >\n            实现\n          </h3>\n        \n<p>dom 交互部分比较简单，这里就不说了，只说说人机对战的逻辑部分。</p>\n<p>要实现机器人自动对战，就要让机器人如何能自动选择最佳位置去下。我在实现的时候采用权重法，就是优先选择权重大的格子下，这样才能最大概率的战胜玩家。那么难点就是如何计算可下区域格子的权重大小呢？我把棋盘采用坐标系的方式表示，对每个格子都有一个固定的值，先计算出可选择区域的格子，然后对每个格子计算出这个格子当前的权重（权重和棋子值不一样）。</p>\n<p>第二个难点就是判断每一步都是否胜利结束游戏，五子棋胜利的判断就是一方连续 5 颗棋子，方向有水平方向，垂直方向，45 度方向和 135 度方向，任意一个方向满足都视为胜利。采用坐标法，那么这个计算就非常简单。</p>\n\n          <h4 id='toc-4-1' >\n            当前棋子权重计算\n          </h4>\n        \n<p>当前棋子权重的计算，考虑到如何最有利于自己获胜，当前棋子在当前方向的权重，计算规则：</p>\n<ol>\n<li>遇到，是机器人的棋子，则加 10</li>\n<li>遇到，当前格子还是可下区域，则加 1</li>\n</ol>\n<pre><code class=\"language-javascript\">if (outerMin >= lineMin &#x26;&#x26; outerMin &#x3C;= lineMax) {\n  if (~currents.indexOf(outerMin)) {\n    winWeight += 10\n  } else if (!~havenBoardStatus.indexOf(outerMin)) {\n    winWeight += 1\n  }\n}\nif (outerMax >= lineMin &#x26;&#x26; outerMax &#x3C;= lineMax) {\n  if (~currents.indexOf(outerMax)) {\n    winWeight += 10\n  } else if (!~havenBoardStatus.indexOf(outerMax)) {\n    winWeight += 1\n  }\n}\n</code></pre>\n\n          <h4 id='toc-4-2' >\n            优先级的逻辑\n          </h4>\n        \n<p>再计算了权重之后，首先要考虑优先级，比如成五比其他情况都优先。\n优先级规则如下：</p>\n<ol>\n<li>当前格子能使自己成五胜利，优先级最高，1</li>\n<li>当前格子下了之后，可成四的线路，如果有多条线路，则优先级其次，2。</li>\n<li>当前格子下了之后，可否使自己成四，并且阻止玩家成四，优先级为 3。</li>\n<li>当前格子下了之后，可否使自己成四，并且使自己其他线路成三，优先级为 4。</li>\n<li>当前格子下了之后，可否使自己成四，并且阻止玩家成三，优先级为 5。</li>\n<li>当前格子下了之后，可否阻止玩家成多条线路的四，优先级为 6。</li>\n<li>当前格子下了之后，可否阻止玩家成四，并且其他线路成三，优先级为 7。</li>\n<li>以此类推…...</li>\n</ol>\n\n          <h3 id='toc-3-4' >\n            效果\n          </h3>\n        \n<p>写完了之后，由于对 Canvas 的扩展性不是很好，所以结果挂了。自己已经尽量抽离了 UI 交互部分和对战逻辑部分，可是对战逻辑部分还是跟 UI 耦合程度还是比较深，主要也是因为自己对 Canvas 不是很熟，后续需要尽量锻炼自己的逻辑抽象思维，准备花时间把数据结构与相关算法在学习一下，<a href=\"https://github.com/snayan/bookLists#2018-%E7%9B%AE%E5%89%8D%E8%AE%A1%E5%88%92\">学习 JavaScript 数据结构与算法(第 2 版)</a>这本书已经加到 2018 的书单计划中了。</p>\n<p>项目地址:<a href=\"https://github.com/snayan/fivepiece\">https://github.com/snayan/fivepiece</a></p>\n<p>最后还是贴一下界面效果图：\n<img src=\"/fivepiece.png\" alt=\"fivePiece\"></p>\n<p>如果想挑战一下的可以开始：<a href=\"https://snayan.github.io/fivepiece/\">https://snayan.github.io/fivepiece/</a></p>","tableOfContents":"<ul><li><a href=\"#toc-3-1\">难点</a><ul><li><a href=\"#toc-4-1\">当前棋子权重计算</a></li><li><a href=\"#toc-4-2\">优先级的逻辑</a></li></ul></li><li><a href=\"#toc-3-2\">思路</a><ul></ul></li><li><a href=\"#toc-3-3\">实现</a><ul></ul></li><li><a href=\"#toc-3-4\">效果</a><ul></ul></li></ul>","frontmatter":{"title":"简单的五子棋","date":"January 23, 2018","tags":["javascript","game"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/gomoku/","previous":{"fields":{"slug":"/post/summary_of_2017/"},"frontmatter":{"title":"2017年小结"}},"next":{"fields":{"slug":"/post/learn_react16_part1/"},"frontmatter":{"title":"React 16学习(-)"}}}}