{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三洋的小站","author":"三洋"}},"markdownRemark":{"id":"2eceb256-b89d-55b4-8766-f9d036255a6c","excerpt":"一直想抽时间总结一下现在业界可用的移动端布局方案。需求多，995 模式，身心被掏空，一拖再拖，终于在周六的晚上，做着梦弄完成的，不足之道 😪，请指教改正 🤠。media+百分比直接采用媒体查询加百分比去布局。核心思想：页面主体布局基本采用百分比去设置。然后，其他块内布局,例如 font-size…","html":"<p>一直想抽时间总结一下现在业界可用的移动端布局方案。需求多，995 模式，身心被掏空，一拖再拖，终于在周六的晚上，做着梦弄完成的，不足之道 😪，请指教改正 🤠。</p>\n<h3>media+百分比</h3>\n<p>直接采用媒体查询加百分比去布局。</p>\n<p>核心思想：</p>\n<ul>\n<li>页面主体布局基本采用百分比去设置。</li>\n<li>然后，其他块内布局,例如 font-size 等可通过设置媒体查询的断点来分设置，已达到兼容其他手机尺寸。</li>\n</ul>\n<!--more-->\n<p>优点：</p>\n<ul>\n<li>灵活，简单</li>\n<li>兼容性好，媒体查询，97.65%的浏览器都支持了。</li>\n</ul>\n<p>缺点：</p>\n<ul>\n<li>媒体查询的断点设置麻烦，只能在选取的几个主流设备尺寸下呈现完美适配。</li>\n<li>1px 的问题，需要额外做处理，比如 transform:scaleX(0.5)。</li>\n</ul>\n<p>例子：京东\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db2f9495be56d06d7752fada8166e710/ab042/media.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 40.67796610169491%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAB2UlEQVQY0w2Qy2vUQADG83d50JseigiKF23B+qrWeikL9rAHodSDSlGQLbUgWFBat1baFRda14N7qA90aWlNNbt5TJLJZGYyyUzeu9usuXyHD37wfT+JMWZbFnQcAIALQEhJFIW+L0DP6Cm2BaChWSbAHiGUUEyogxBELibE51x6vrDw+N79ytzc7PT07o2pn5VqEoZpNoAagoCFXFAiMEkiwX0/4cQTyEkZiykWLpLmKw+uXrk2Pjk1cX3m4Wx1/PydwOej0ShnJCIoYsEwy0/yfjE6KcsYQ9DtOpZJkMMIkW5evD1z+kJl7PKtU+cmz45NnLmEqHi3J1417bUdde0Let/G9a+4zI02bX/TA0aCMMoGgzTPpdX1ndeLW63l5u76xrO3tdX6G8qSxQZ9+gG+bChL22qtYdY+Gktbf5/Ule2WWsrwLDPELkdQ+qyxgwM373UDq9MzD38EZtHvlwvTOIRGV1dtWcE93cWWTpGdJUlSqnKg73nC9yUEVfi7SVWZ/dvH3zdNs5PlwxIOAi4fHR/LYP8IyQoyNE3TLY/xJBQlxrngQkiZ+SddqQYrj8SL+Xj5bna4WbJZmlDqaarZ7sBPe6j1Cxs29QIehxG17fJtURTD4fA/pIiLVCuvnJwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"hotcss\"\n        title=\"\"\n        src=\"/static/db2f9495be56d06d7752fada8166e710/b9e4f/media.png\"\n        srcset=\"/static/db2f9495be56d06d7752fada8166e710/cf440/media.png 148w,\n/static/db2f9495be56d06d7752fada8166e710/d2d38/media.png 295w,\n/static/db2f9495be56d06d7752fada8166e710/b9e4f/media.png 590w,\n/static/db2f9495be56d06d7752fada8166e710/f9b6a/media.png 885w,\n/static/db2f9495be56d06d7752fada8166e710/2d849/media.png 1180w,\n/static/db2f9495be56d06d7752fada8166e710/ab042/media.png 2360w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h3>hotcss</h3>\n<p>这个方案比较简单和实用，理解起来也不难。项目地址<a href=\"https://github.com/imochen/hotcss\">查看这里</a></p>\n<p>原理：</p>\n<ul>\n<li>自动通过 hotcss.js 计算页面的<code class=\"language-text\">html</code>的<code class=\"language-text\">font-size</code>的大小，其后在布局中使用 rem 作为像素单位，使得页面在不同的移动设备上可以视觉一致。</li>\n<li>通过获取 dpr，在<code class=\"language-text\">html</code>上设置属性<code class=\"language-text\">data-dpr</code>，在设置<code class=\"language-text\">font-size</code>时，可以配合<code class=\"language-text\">data-dpr</code>来使用 px 作为像素单位。</li>\n<li>计算 scale，为页面设置<code class=\"language-text\">viewport</code>，使得页面根据 dpr 进行缩放，最终达到，1 个物理像素=1px。这样，也有效解决了 1px 的问题。</li>\n<li>默认在 320px 屏幕中（非 Retina 屏），1rem=20px;</li>\n</ul>\n<p>核心源码：</p>\n<p>计算 dpr 并设置<code class=\"language-text\">data-dpr</code>和<code class=\"language-text\">scale</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// 计算dpr</span>\n<span class=\"token keyword\">var</span> dpr <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>devicePixelRatio <span class=\"token operator\">||</span> <span class=\"token number\">1</span>\n<span class=\"token comment\">// 在其他的一些方案中，会区分ios和android，对android统一设置为1.</span>\ndpr <span class=\"token operator\">=</span> dpr <span class=\"token operator\">>=</span> <span class=\"token number\">3</span> <span class=\"token operator\">?</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">:</span> dpr <span class=\"token operator\">>=</span> <span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n<span class=\"token comment\">// 设置data-dpr</span>\ndocument<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data-dpr\"</span><span class=\"token punctuation\">,</span> dpr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 计算scale</span>\n<span class=\"token keyword\">var</span> scale <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> dpr<span class=\"token punctuation\">,</span>\n  content <span class=\"token operator\">=</span>\n    <span class=\"token string\">\"width=device-width,initial-scale=\"</span> <span class=\"token operator\">+</span>\n    scale <span class=\"token operator\">+</span>\n    <span class=\"token string\">\",minimum-scale=\"</span> <span class=\"token operator\">+</span>\n    scale <span class=\"token operator\">+</span>\n    <span class=\"token string\">\",maximum-scale=\"</span> <span class=\"token operator\">+</span>\n    scale <span class=\"token operator\">+</span>\n    <span class=\"token string\">\",user-scalable=no\"</span>\n<span class=\"token comment\">// 插入meta，设置页面缩放</span>\n<span class=\"token keyword\">var</span> viewport <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"meta\"</span><span class=\"token punctuation\">)</span>\nviewport<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"viewport\"</span><span class=\"token punctuation\">)</span>\nviewport<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span>\ndocument<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>viewport<span class=\"token punctuation\">)</span></code></pre></div>\n<p>计算<code class=\"language-text\">font-size</code>并设置<code class=\"language-text\">html</code>的<code class=\"language-text\">font-size</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//获取设备的宽度</span>\n<span class=\"token keyword\">var</span> innerWidth <span class=\"token operator\">=</span>\n  document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>innerWidth\n<span class=\"token comment\">//计算font-seize，默认320px中，1rem=20px.</span>\ndocument<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>fontSize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>innerWidth <span class=\"token operator\">*</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">320</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"px\"</span></code></pre></div>\n<p>优点：</p>\n<ul>\n<li>后续布局处理简单，配合 px2rem 插件等，使用十分方便。</li>\n<li>基本能很好适配市面即大多数尺寸手机。</li>\n<li>兼容性也比较好,97.62%浏览器基本支持 rem 单位了。</li>\n<li>通过设置缩放比例，有效解决了 1px 的问题。</li>\n</ul>\n<p>缺点：</p>\n<ul>\n<li>页面需要额外引入 js 脚本去计算，增加一次额外的 http 请求，或内嵌到页面中增加页面体积大小。</li>\n</ul>\n<p>例子：卷皮\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af52ec43cd19b1b626e3e47775b680db/087d3/hotcss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50.980392156862756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAB8ElEQVQozx1S2XKbQADj/3+kj31spk3q1jYQe5o0TWIcL8eyXLvc7MWyGHBp9aqRNBrJkFrndV2URVmVJaWYsaqXlDHa1HkAUxekAFQQ5L5bBCAPfOz7xHMrgqu6NiSKVBT3lEpK+wtQO6u3D4oL3UsOfAYcCoPW93mcySQRScqjRKXkNvTzshgDitjFlR1Vgg+n83B3P2y2mov5tvR0KD0P+bHndVlUxKhsi4I2nR6GaZqv16tx1ZpR2lEqpOTDIK5XNo5qpedJ0qEK/Ajik9OEQZmHQeA1Ydjpnqte62E0akzyNCOEYIybpslgRFC8Gq1iLXUDoQsT+1S4iOAInZ2sKejtP+Z5MsIo3lrW4XC8XIB1/LX79Pn160bqf8mCjQSm0EdPz9nba+Y45P09O70VadwkcQsRNXCWvr38BuAcIegA4IMTDBHnfFD6+Sn5/g0cTfDz4ePuLtibsWkn5mNi2rF1SA82NCYCb+/HhZu3zvqi20ALs1rUNPdt9/Lo2jtntz1blr/bnx9+BJtduNnCvY3sJ/xnfzJY27JqnbZToisFF6qvmNTjuEyjpF3kuQhlISyblKQwb7K1OcFJxTs2K2EwztdLLMsyz3NdlqMeVVsoKZbbUnfq45KRMIoSlpQ9qWjeCB/LsFRZsd5C/QUq7hxYqbmcFwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"hotcss\"\n        title=\"\"\n        src=\"/static/af52ec43cd19b1b626e3e47775b680db/b9e4f/hotcss.png\"\n        srcset=\"/static/af52ec43cd19b1b626e3e47775b680db/cf440/hotcss.png 148w,\n/static/af52ec43cd19b1b626e3e47775b680db/d2d38/hotcss.png 295w,\n/static/af52ec43cd19b1b626e3e47775b680db/b9e4f/hotcss.png 590w,\n/static/af52ec43cd19b1b626e3e47775b680db/f9b6a/hotcss.png 885w,\n/static/af52ec43cd19b1b626e3e47775b680db/2d849/hotcss.png 1180w,\n/static/af52ec43cd19b1b626e3e47775b680db/087d3/hotcss.png 1836w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h3>flexible</h3>\n<p>这个是手机淘宝推出来一个方案，解决手机淘宝 H5 在移动端的布局。项目地址<a href=\"https://github.com/amfe/lib-flexible\">查看这里</a></p>\n<p>原理：</p>\n<ul>\n<li>自动通过 flexible.js 计算页面<code class=\"language-text\">html</code>的<code class=\"language-text\">font-size</code>的大小，然后在页面布局中使用 rem 作为单位，而非 px。</li>\n<li>如果页面指定了<code class=\"language-text\">meta[name=&quot;viewport&quot;]</code>，则直接根据已有的 meta 标签来设置缩放比例；否则，通过<code class=\"language-text\">dpr</code>来自动计算页面缩放比例。</li>\n<li>设置 1rem=10vw，例如，在 320px 屏幕（非 Retina 屏），1rem=32px；</li>\n</ul>\n<p>核心源码：</p>\n<p>计算缩放比例</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//参试获取页面已定义的缩放比例</span>\n<span class=\"token keyword\">var</span> metaEl <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meta[name=\"viewport\"]'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>metaEl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"将根据已有的meta标签来设置缩放比例\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">var</span> match <span class=\"token operator\">=</span> metaEl<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/initial\\-scale=([\\d\\.]+)/</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    scale <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    dpr <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> scale<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//如果没有，则自动计算</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>dpr <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>scale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> isAndroid <span class=\"token operator\">=</span> win<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>appVersion<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/android/gi</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">var</span> isIPhone <span class=\"token operator\">=</span> win<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>appVersion<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/iphone/gi</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">var</span> devicePixelRatio <span class=\"token operator\">=</span> win<span class=\"token punctuation\">.</span>devicePixelRatio\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isIPhone<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>devicePixelRatio <span class=\"token operator\">>=</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>dpr <span class=\"token operator\">||</span> dpr <span class=\"token operator\">>=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      dpr <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>devicePixelRatio <span class=\"token operator\">>=</span> <span class=\"token number\">2</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>dpr <span class=\"token operator\">||</span> dpr <span class=\"token operator\">>=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      dpr <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      dpr <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 其他设备下，仍旧使用1倍的方案</span>\n    dpr <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span>\n  scale <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> dpr\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>设置 meta</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>metaEl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  metaEl <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"meta\"</span><span class=\"token punctuation\">)</span>\n  metaEl<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"viewport\"</span><span class=\"token punctuation\">)</span>\n  metaEl<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"content\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"initial-scale=\"</span> <span class=\"token operator\">+</span>\n      scale <span class=\"token operator\">+</span>\n      <span class=\"token string\">\", maximum-scale=\"</span> <span class=\"token operator\">+</span>\n      scale <span class=\"token operator\">+</span>\n      <span class=\"token string\">\", minimum-scale=\"</span> <span class=\"token operator\">+</span>\n      scale <span class=\"token operator\">+</span>\n      <span class=\"token string\">\", user-scalable=no\"</span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>docEl<span class=\"token punctuation\">.</span>firstElementChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    docEl<span class=\"token punctuation\">.</span>firstElementChild<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>metaEl<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> wrap <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span>\n    wrap<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>metaEl<span class=\"token punctuation\">)</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>wrap<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>计算页面的 html 的 font-size</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> width <span class=\"token operator\">=</span> docEl<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width\n<span class=\"token comment\">//最大屏幕宽度为540*dpr</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>width <span class=\"token operator\">/</span> dpr <span class=\"token operator\">></span> <span class=\"token number\">540</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  width <span class=\"token operator\">=</span> <span class=\"token number\">540</span> <span class=\"token operator\">*</span> dpr\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//设置1rem=10vw</span>\n<span class=\"token keyword\">var</span> rem <span class=\"token operator\">=</span> width <span class=\"token operator\">/</span> <span class=\"token number\">10</span>\ndocEl<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>fontSize <span class=\"token operator\">=</span> rem <span class=\"token operator\">+</span> <span class=\"token string\">\"px\"</span>\nflexible<span class=\"token punctuation\">.</span>rem <span class=\"token operator\">=</span> win<span class=\"token punctuation\">.</span>rem <span class=\"token operator\">=</span> rem</code></pre></div>\n<p>优缺点同 hotcss。</p>\n<p>例子：淘宝\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e19bf945503c353cb2bb8060ca7af78f/01cfd/flexible.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50.384193194291996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAPoAAAD6AG1e1JrAAACIElEQVQozzWOSWsUQQCF+y8J/gJPglcRvYgXEY/iUfEgQRRBoiDRQzQuGCREc1NiQxBNJonDTGYyWy/VW3VXdXX1vkx199T0OBh8PD7e5YMnZLyhbObXc7/kdDojRR3zJpmyyKcE6LYs25JMddVVgQsAXlIFWFGXOzQNod57h57chiu38Opd79U99OwOeHgzH/0py5q0T93+MDV15kDmeqVLauIxRArkFohwgoXtx/e3r55/euXS6o3LK9evrV08l14QmPiRLxYsmfqaAXVkaFFKIUQxChirZov/EbZ64ovdN8/Fz2vi5qfO1pfd9e7pWxxNmvmimlYhRJpGZSmKsNlViHjiAZQsteZM/o5+PhI3Hmy+/NDfeL23vv7+x0Gr7ZROw5syrwLDcEwbGh6BcKgE3THVzIgV1ZktmFZvsP9V7x+0T7Rh93f7247YtnOW8TlnWYVkADUDKB6YmNAMKQ4dO44iVv07L+QIu4fHTV+Sj2E4GTN3dDSGdVVzXqdJqStQUezDE9ruu+0eOujgvhqOrXQCszirBIakaW+nDFpNvFcrvfJ4tBjt1FXFOY+TUpJdoOGhmgCY2A6WjHBgpMDNIc5pXAmFTzPbijHyCQ6IG1IaBXTGeZWnpD/UWz2jNSCSEpog0K1AN6lmLBlqRmxZQuHYBVDLJLX8GIdxGASObc/m87pIE0XT9zunv47UoxHqDDxZzx1UILxsZmNG3L/+JwWsijNoUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"hotcss\"\n        title=\"\"\n        src=\"/static/e19bf945503c353cb2bb8060ca7af78f/b9e4f/flexible.png\"\n        srcset=\"/static/e19bf945503c353cb2bb8060ca7af78f/cf440/flexible.png 148w,\n/static/e19bf945503c353cb2bb8060ca7af78f/d2d38/flexible.png 295w,\n/static/e19bf945503c353cb2bb8060ca7af78f/b9e4f/flexible.png 590w,\n/static/e19bf945503c353cb2bb8060ca7af78f/f9b6a/flexible.png 885w,\n/static/e19bf945503c353cb2bb8060ca7af78f/2d849/flexible.png 1180w,\n/static/e19bf945503c353cb2bb8060ca7af78f/01cfd/flexible.png 1822w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h3>rem+vw</h3>\n<p>这种方案就是在计算 html 的 font-size 时，是根据 vw 去自动计算，而不是用 js 脚本去动态计算。vw 是一种新的单位，类似的还有 vh，vmin，vmax。定义如下：</p>\n<ul>\n<li>vw：1vw 等于视口宽度的 1%；例如，320px 宽度视口中，1vw=3.2px，10vw=32px，100vw=320px；</li>\n<li>vh：1vh 等于视口高度的 1%；例如，568px 高度视口中，1vh=5.58px，10vh=56.8px，100vh=568px；</li>\n<li>vmin：选取 vw 和 vh 中最小的那个；</li>\n<li>vmax：选取 vw 和 vh 中最大的那个；</li>\n</ul>\n<p>核心思想：</p>\n<p>不用 js 去动态计算页面的 font-size ，而是设置根元素 html 的 font-size=<em>a</em> vw；这里的<em>a</em>，可以选取一种屏幕尺寸去参考计算。例如，我们想 iPhone6 下，html 的 font-size 为 100px。那个 html 的 font-size=100/375=0.26666666666666666vw。那么，其他屏幕的适配计算方式就是:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">iphone5<span class=\"token punctuation\">:</span>屏幕是<span class=\"token number\">320</span><span class=\"token operator\">*</span><span class=\"token number\">568</span>\nhtml的font<span class=\"token operator\">-</span>size<span class=\"token operator\">=</span><span class=\"token number\">0.26666666666666666</span><span class=\"token operator\">*</span><span class=\"token number\">320</span><span class=\"token operator\">=</span><span class=\"token number\">85.33333333333333</span>\n\niphone6s<span class=\"token punctuation\">:</span>屏幕是<span class=\"token number\">414</span><span class=\"token operator\">*</span><span class=\"token number\">736</span>\nhtml的font<span class=\"token operator\">-</span>size<span class=\"token operator\">=</span><span class=\"token number\">0.26666666666666666</span><span class=\"token operator\">*</span><span class=\"token number\">414</span><span class=\"token operator\">=</span><span class=\"token number\">110.39999999999999</span></code></pre></div>\n<p>页面布局采用 rem 布局，而非 px。根据 html 的 font-size 和 rem 单位自动计算出了布局 px。</p>\n<p>优点：</p>\n<ul>\n<li>不需要额外引入 js 脚本去计算，自动根据 vw 去计算 font-size</li>\n<li>后续布局也超级简单，采用 rem 即可。</li>\n</ul>\n<p>缺点：</p>\n<ul>\n<li>vw 单位的支持相对比 rem 的浏览器少一些，目前有 93.65%的浏览器都支持了。</li>\n</ul>\n<p>例子：拼多多\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4a25f3227939fff551e4d7dc1fc09e47/40e57/vw%2Brem.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 43.06177260519248%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAPoAAAD6AG1e1JrAAABzElEQVQoz12PS2/TQBSF/S/hPyAhVFZdwZYICbWKxAa2SMCuRaVqQUJFCotKhDQhcdL4PR4787Y99tgePxhYcnTuuaur71wLIUwZM0YImcmzLMV85ZK7PbJDvg2o7RPjtYu2AYliCGIAkySGkHFu5S9Ps8kJP3mdT6fF1VflOLRs71Zo/hverg+/tnzhVGuvtKN6DxVHuJGFVlVXq7rILfrxjHw4z86vyosv1fVN5UfdOMpDjlw7ckN2YFrypix12/eqkvudjIGIwhKjAgJLTt/wd++Hoxfd8avh4VN9edOOIwMstHfOPUqC0N0B3xciqwshmXMvwkBEgQCAhIGVfb5M5j/6B0/aZ6fa5MU3Q058ai/BdkO8HYQhi6MMhFma5AQhihDP8rppOBdWRYXu+n6zH7xwsJ0WUz30IBLzRTS7hYtV9NPGG4+7IPdhxjDOOc+LQilFCLE09syLqtAM98ulx3mpdWtogWl+kCnJ97CAVBWqE2WDk8SQk/TAOaeEWsKe+bNPo9Cr74ujR49Xi/U4jl3djv34n0w/TkguOGNcSimEsCbPj8/eTiSMWopl6mtVxkRBWum26fvByOS/Peiu+0tOU0KpOaaU/gFN7+D3txySqgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"hotcss\"\n        title=\"\"\n        src=\"/static/4a25f3227939fff551e4d7dc1fc09e47/b9e4f/vw%2Brem.png\"\n        srcset=\"/static/4a25f3227939fff551e4d7dc1fc09e47/cf440/vw%2Brem.png 148w,\n/static/4a25f3227939fff551e4d7dc1fc09e47/d2d38/vw%2Brem.png 295w,\n/static/4a25f3227939fff551e4d7dc1fc09e47/b9e4f/vw%2Brem.png 590w,\n/static/4a25f3227939fff551e4d7dc1fc09e47/f9b6a/vw%2Brem.png 885w,\n/static/4a25f3227939fff551e4d7dc1fc09e47/2d849/vw%2Brem.png 1180w,\n/static/4a25f3227939fff551e4d7dc1fc09e47/40e57/vw%2Brem.png 2234w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>","frontmatter":{"title":"移动端布局方案浅谈","date":"July 31, 2017"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/mobile-layout/","previous":{"fields":{"slug":"/post/img_srcset_seizes/"},"frontmatter":{"title":"响应式图片加载"}},"next":{"fields":{"slug":"/post/mini_program_component_programming/"},"frontmatter":{"title":"小程序组件化编程"}}}}