{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三羊的小站","author":"三羊","postPath":"/post","contentUrl":"https://github.com/snayan/blog-source/tree/master/content/blog","ableZan":false,"menu":{"search":{"name":"搜索","link":"/search"}}}},"markdownRemark":{"id":"572e4885-d2de-5e91-99bf-3eef42216401","excerpt":"这篇是学习和回顾 canvas 系列笔记的第一篇，完整笔记详见：canvas 核心技术\n学习 canvas，首先得知道如何去绘制线段，然后才能通过很多简单的线段去实现比较复杂的图形，比如常见的图表，柱状图，折线图等都是通过一段一段的线段实现的。canvas…","html":"<p>这篇是学习和回顾 canvas 系列笔记的第一篇，完整笔记详见：<a href=\"/post/core_html5_canvas/\">canvas 核心技术</a>\n学习 canvas，首先得知道如何去绘制线段，然后才能通过很多简单的线段去实现比较复杂的图形，比如常见的图表，柱状图，折线图等都是通过一段一段的线段实现的。</p>\n\n        <h3 id='toc-3-1' >\n          基础知识\n        </h3>\n      \n<p>canvas 的基础知识不算多，主要掌握如何绘制线段，图形，图片，文本等。canvas 可以在浏览器中绘制，也可以借助 <a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>在 node 服务端绘制简单的图片。本文只记录在浏览器中绘制，至于在 node 端如何绘制，自己可以去查看相关资料。</p>\n<p>在浏览器中绘制，就先在 html 中定义 canvas 元素，默认宽高是 300 * 150，可以通过<code class=\"language-text\">width</code>和<code class=\"language-text\">height</code>设置。注意 canvas 元素样式宽高和 canvas 绘图画布宽高不是一个东西，详见<em>知识点 5 中 canvas 宽高</em>。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>canvas<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>当前浏览器不支持canvas，请升级浏览器<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<!--more-->\n<p>在绘制之前，我们要先获取当前 canvas 的 2d 绘制上下文 context，后续总是通过操作 context 来进行绘制。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#canvas\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"can not find canvas element\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 注意2d.参数必须是小写的；</span>\n<span class=\"token comment\">// 通过设置参数为webgl，可以获取3d绘制上下文</span>\n<span class=\"token keyword\">let</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><em>注：后续示例中会忽略上面的代码片段，直接使用 <code class=\"language-text\">ctx</code> 变量表示 canvas 的 2d 绘制上下文。</em></p>\n<p>再来看看 canvas 2d 绘制中的坐标系统，当前 canvas 元素左上角为坐标原点(0,0)，水平向右为 X 轴正方向，垂直向下为 Y 轴正方向，如下图。可以通过平移(translate)，旋转(rotate)，缩放(scale)来操作坐标系，实现一些动画，这部分将在动画知识部分详细讲解。</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/45947533f882772c7ce14d66f43aafdf/e5f70/coordinate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 513px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 69.39571150097466%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAChklEQVQoz12S+0/aUBTH+Qf3P+x/ULehA1QefV/6AEWdoG4+IsoEzZJNF1BBSktpC72UIsW2INmS/RG7FLKHyScn5/zwyfeekxvYOlWoksyUFLooUxcSUZTwzyJekLCCFCuI0UJ9/fwhcl5bzVcRkdNq6KwWzNeC5/WVg1ogd2eAiSG4Hd6Daa+36cGNsZkedVHdHE/rxrOZee6nfvRTP3uZgbFldTK2sW13NjQ9sFcxgGOkoZZu3nHqN+JRwjwNc1TC1XFHJ5w2/aRjj1VBrQk9NWW0d2qtbUS9xdfVwN4tBEOd9QY7rfxx7jWdfcdmF9m9RfZgCXx6y+4vRPKRVzDI3J5kdJkbmbxjsE8dbgQ5lLx/C5PDNudZu3JFXw5qUaIapsohphyiK2EgvomXSABGluB0eQcKQ4O3fVxjLgNb50bWrlRWwssPBHkXJ6+jzJQYqESwzwAAz+QHbR6ZQ0N4gjOZVbXAPjqY3WZH/Q+Nm1ZoWcSoRgKTMVxJYBKOq+vRC5JOeqYwM/3K2R3ehVP54z3aGclWtn6jRt4/ELSIEyJG1hE4JccSFySTdE0eCbPYf+XD+9mz+7vidy20Ikex1mqsuRZT1uLyelwLr13FEsCBM3mObQief7Cje5MZ6Mlx/+jrWW1poURzVwR1RdKXCIr5kiCPWZ5F17KNvzJ6guvLx9UuGOjMxL4sZi+LOeyXhzYEY4sZ9/xqofG/2Onm0E/WpjJKZr1ernGD4BxTQIcdtAUk+M0Lc+57kEXJJ3ULOO3UxMo0KzvitTCxUq6R8uAMYd50/1T0c1MuTD93hY4eOCxDrKUwug6UZlJqUJpGq+pLNJXSVUpDjUbpGonGjkZWld9YIFOBN81j9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/45947533f882772c7ce14d66f43aafdf/cc182/coordinate.webp 148w,\n/static/45947533f882772c7ce14d66f43aafdf/f7e40/coordinate.webp 295w,\n/static/45947533f882772c7ce14d66f43aafdf/aef14/coordinate.webp 513w\"\n          sizes=\"(max-width: 513px) 100vw, 513px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/45947533f882772c7ce14d66f43aafdf/cf440/coordinate.png 148w,\n/static/45947533f882772c7ce14d66f43aafdf/d2d38/coordinate.png 295w,\n/static/45947533f882772c7ce14d66f43aafdf/e5f70/coordinate.png 513w\"\n          sizes=\"(max-width: 513px) 100vw, 513px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/45947533f882772c7ce14d66f43aafdf/e5f70/coordinate.png\"\n          alt=\"坐标系统\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n\n        <h3 id='toc-3-2' >\n          线段\n        </h3>\n      \n<p>在绘制一条简单的线段时，一般会先设置线段的样式，比如，颜色，线条宽度，线条端点样式等，我们通过设置<code class=\"language-text\">strokeStyle</code>来设置<code class=\"language-text\">ctx</code>的全局绘制样式，可以是<code class=\"language-text\">rgba</code>或合法的 16 进制颜色值，或者渐变对象等。如下代码简单的绘制了一条从(10,10)到(50,60)的，宽度为 10 的，红色的线段。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"red\"</span>\nctx<span class=\"token punctuation\">.</span>lineWidth <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3b2f956f3f18d569a9e11a596d4f2244/a111b/line.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7UCmD/xAAVEAEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIK/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERECH/2gAIAQEAAT8hle1Mg9R//9oADAMBAAIAAwAAABB0z//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxBdn//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAMBAQEAAAAAAAAAAAAAAAABESFRcf/aAAgBAQABPxBu1CpNaurwjiMPCvrK+s1af//Z'); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/3b2f956f3f18d569a9e11a596d4f2244/cc182/line.webp 148w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/f7e40/line.webp 295w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/1a2f4/line.webp 590w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/001d9/line.webp 650w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/3b2f956f3f18d569a9e11a596d4f2244/8ee9c/line.jpg 148w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/ebbe7/line.jpg 295w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/c739e/line.jpg 590w,\n/static/3b2f956f3f18d569a9e11a596d4f2244/a111b/line.jpg 650w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/3b2f956f3f18d569a9e11a596d4f2244/c739e/line.jpg\"\n          alt=\"line\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>先看看与绘制线段相关的方法以及属性，</p>\n<p>相关属性：</p>\n<ul>\n<li>lineCap，该值告诉浏览器如何绘制线段的端点，可选值为以下三个之一：butt，round，square。默认为 butt。</li>\n<li>lineWidth，该值决定了线段的像素宽度。必须为非负，非无穷，默认为 1.0。</li>\n<li>lineJoin，决定了两条线段相交时如何绘制焦点，只有当两条线段方向不同时，才会生效。可取值：bevel，round，miter。默认值是 miter。</li>\n<li>miterLimit，告诉浏览器如何绘制 miter 形式的线段焦点，只有当<code class=\"language-text\">lineJoin=&#39;miter&#39;</code>有效，默认为 10.0。</li>\n<li>lineDashOffset，设置虚线偏移量，默认为 0.0。</li>\n</ul>\n<p>相关方法：</p>\n<ul>\n<li>beginPath，将当前路径之中的所有子路径都要清除掉，以此来重置当前路径。一般在绘制闭合图形时要先调用。</li>\n<li>closePath ,显示的封闭某段路径。该方法用于封闭圆弧路径以及由曲线或线段所创建的开放路径。</li>\n<li>moveTo，移动当前绘制点到指定的坐标。</li>\n<li>lineTo，从上一个点绘制一条到指定坐标点的线段。</li>\n<li>setLineDash，用来设置虚线的方法，参数是一个数组，表明绘制实线的长度，以及实线之间的间隙的长度。</li>\n</ul>\n<p>试试用设置不同的<code class=\"language-text\">lineCap</code>值来绘制同样的线段</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span>lineWidth <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">\"center\"</span>\n<span class=\"token keyword\">let</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> lineCaps <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"butt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"round\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"square\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> lc<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lineCaps<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 设置线段的颜色</span>\n  ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n  <span class=\"token comment\">// 设置lineCap</span>\n  ctx<span class=\"token punctuation\">.</span>lineCap <span class=\"token operator\">=</span> lc\n  <span class=\"token comment\">// 清空当前路径</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span>lc<span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b99771ca0a904daf1846dfd9e3fc7a94/aa4ed/lineCap.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 51.09034267912773%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHatgDEH//EABcQAQADAAAAAAAAAAAAAAAAAAECESD/2gAIAQEAAQUCiN5//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhABAQEAAAAAAAAAAAAAAAAAAREg/9oACAEBAAY/Amuv/8QAGRABAQEAAwAAAAAAAAAAAAAAAQARECEx/9oACAEBAAE/IToCL1ZPttvH/9oADAMBAAIAAwAAABBwz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAMBAQEBAAAAAAAAAAAAAAABESFRMZH/2gAIAQEAAT8QqiAm4twji+CpYRXWV1lvp//Z'); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/b99771ca0a904daf1846dfd9e3fc7a94/cc182/lineCap.webp 148w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/f7e40/lineCap.webp 295w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/1a2f4/lineCap.webp 590w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/43770/lineCap.webp 642w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b99771ca0a904daf1846dfd9e3fc7a94/8ee9c/lineCap.jpg 148w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/ebbe7/lineCap.jpg 295w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/c739e/lineCap.jpg 590w,\n/static/b99771ca0a904daf1846dfd9e3fc7a94/aa4ed/lineCap.jpg 642w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/b99771ca0a904daf1846dfd9e3fc7a94/c739e/lineCap.jpg\"\n          alt=\"lineCap\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>从上图结果可以看出，再将<code class=\"language-text\">lineCap</code>设置为<strong>round</strong> 和<strong>square</strong>时会在原线段的两端加上一定长度的端点，只不过<strong>round</strong>是圆弧样式，<strong>square</strong>是矩形样式。需要注意的一点是，在 canvas 绘制上下文中同一时刻只能存在一个当前路径，为了绘制不同的线段，必须在每次绘制之前调用<code class=\"language-text\">beginPath()</code>来清空当前路线，开始新的路径。</p>\n<p>再来试试用不同的<code class=\"language-text\">lineJoin</code>值来绘制两个线段焦点处的样式</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span>lineWidth <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\nctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">\"center\"</span>\nctx<span class=\"token punctuation\">.</span>lineCap <span class=\"token operator\">=</span> <span class=\"token string\">\"butt\"</span>\n<span class=\"token keyword\">let</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> lineJoins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"bevel\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"round\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"miter\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> lj<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lineJoins<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 设置线段的颜色</span>\n  ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n  <span class=\"token comment\">// 设置lineJoin</span>\n  ctx<span class=\"token punctuation\">.</span>lineJoin <span class=\"token operator\">=</span> lj\n  <span class=\"token comment\">// 清空当前路径</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token number\">80</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> <span class=\"token number\">80</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> <span class=\"token number\">80</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span>lj<span class=\"token punctuation\">,</span> <span class=\"token number\">40</span> <span class=\"token operator\">+</span> <span class=\"token number\">80</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93203712a27010729a1b9dba0632aead/c59a2/lineJoin.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52.36593059936908%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHYW4JFD//EABkQAAEFAAAAAAAAAAAAAAAAAAEAEhMgIf/aAAgBAQABBQJmxlGn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/ATV//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/ARF//8QAGxABAAEFAQAAAAAAAAAAAAAAAREAAiAhIqH/2gAIAQEABj8CdsNWdsnuP//EABkQAAMBAQEAAAAAAAAAAAAAAAAhMREBYf/aAAgBAQABPyG9ZNnfBdK3BRpp0//aAAwDAQACAAMAAAAQ/M//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QVVz/xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8QVUz/xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMUFR/9oACAEBAAE/EBKauVfTq8hcNCvatMS982ABnkFXWW+sSvZ//9k='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/93203712a27010729a1b9dba0632aead/cc182/lineJoin.webp 148w,\n/static/93203712a27010729a1b9dba0632aead/f7e40/lineJoin.webp 295w,\n/static/93203712a27010729a1b9dba0632aead/1a2f4/lineJoin.webp 590w,\n/static/93203712a27010729a1b9dba0632aead/ab069/lineJoin.webp 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/93203712a27010729a1b9dba0632aead/8ee9c/lineJoin.jpg 148w,\n/static/93203712a27010729a1b9dba0632aead/ebbe7/lineJoin.jpg 295w,\n/static/93203712a27010729a1b9dba0632aead/c739e/lineJoin.jpg 590w,\n/static/93203712a27010729a1b9dba0632aead/c59a2/lineJoin.jpg 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/93203712a27010729a1b9dba0632aead/c739e/lineJoin.jpg\"\n          alt=\"lineJoin\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>可以看到，三种<code class=\"language-text\">lineJoin</code>在处理两条线段的焦点处的不同。其中，在设置<code class=\"language-text\">lineJoin=&quot;miter&quot;</code>时，通过设置<code class=\"language-text\">miterLimit</code>属性可以设置斜接线的长度与二分之一线宽的最大比值，当超过这个比值时，则<code class=\"language-text\">lineJoin</code>会采用<strong>bevel</strong>方式。</p>\n<p>canvas 不仅可以绘制实线，还可以绘制虚线。绘制虚线，通过设置<code class=\"language-text\">lineDashOffset</code>属性和调用<code class=\"language-text\">setLineDash()</code>方式。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span>lineWidth <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">\"center\"</span>\n<span class=\"token comment\">// 表示实线部分8个像素，间隙部分8个像素</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">setLineDash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> lineDashOffsets <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> ldOffset<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lineDashOffsets<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 线段颜色</span>\n  ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n  <span class=\"token comment\">// 设置了偏移量</span>\n  ctx<span class=\"token punctuation\">.</span>lineDashOffset <span class=\"token operator\">=</span> ldOffset\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`lineDashOffset:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ldOffset<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1d9166a538458656648e89549280590a/c59a2/lineDashOffset.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 53.31230283911672%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdq0DJD/xAAYEAADAQEAAAAAAAAAAAAAAAAAARECEP/aAAgBAQABBQJLVQyl5//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAMBAQEAAAAAAAAAAAAAAAABETEhcf/aAAgBAQABPyHQz0R3pooobP/aAAwDAQACAAMAAAAQsM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABACExYf/aAAgBAQABPxARX3sGuyAYvS9JF1v/2Q=='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/1d9166a538458656648e89549280590a/cc182/lineDashOffset.webp 148w,\n/static/1d9166a538458656648e89549280590a/f7e40/lineDashOffset.webp 295w,\n/static/1d9166a538458656648e89549280590a/1a2f4/lineDashOffset.webp 590w,\n/static/1d9166a538458656648e89549280590a/ab069/lineDashOffset.webp 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/1d9166a538458656648e89549280590a/8ee9c/lineDashOffset.jpg 148w,\n/static/1d9166a538458656648e89549280590a/ebbe7/lineDashOffset.jpg 295w,\n/static/1d9166a538458656648e89549280590a/c739e/lineDashOffset.jpg 590w,\n/static/1d9166a538458656648e89549280590a/c59a2/lineDashOffset.jpg 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/1d9166a538458656648e89549280590a/c739e/lineDashOffset.jpg\"\n          alt=\"lineDashOffset\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>从图可以看到<code class=\"language-text\">lineDashOffset</code>就是设置的开始绘制虚线的偏移量。<code class=\"language-text\">setLineDash()</code>方法，接受一个数组参数，如果数组个数是奇数，则会默认把当前数组元素复制一份，使之变成偶数。从第 0 个元素，表示实线部分长度，第 1 个元素，表示间隙部分长度，第 2 个元素，表示实线部分长度，第 3 个元素，表示间隙部分长度，如果到数组最后一个元素了，又会从头开始，以此类推。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span>lineWidth <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">\"center\"</span>\n<span class=\"token keyword\">let</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gray\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> lineDashes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> ld<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lineDashes<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n  <span class=\"token comment\">// 设置lineDash</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">setLineDash</span><span class=\"token punctuation\">(</span>ld<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`lineDashes:[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ld<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]`</span></span><span class=\"token punctuation\">,</span> <span class=\"token number\">240</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> index<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ef4dc9a06709a4a2c5697fbb84dc92c3/e3959/setLineDash.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 53.459119496855344%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAexuiA//xAAZEAACAwEAAAAAAAAAAAAAAAAAERASISL/2gAIAQEAAQUC6W1GOP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAMBAQEAAAAAAAAAAAAAAAABESFxsf/aAAgBAQABPyFKVe+CwqdOlFDZ/9oADAMBAAIAAwAAABAzD//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhMUFh/9oACAEBAAE/EMrB2rV0GzHb1yG2B7HLCw2uek9Iy5Z//9k='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/ef4dc9a06709a4a2c5697fbb84dc92c3/cc182/setLineDash.webp 148w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/f7e40/setLineDash.webp 295w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/1a2f4/setLineDash.webp 590w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/9fd29/setLineDash.webp 636w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/ef4dc9a06709a4a2c5697fbb84dc92c3/8ee9c/setLineDash.jpg 148w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/ebbe7/setLineDash.jpg 295w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/c739e/setLineDash.jpg 590w,\n/static/ef4dc9a06709a4a2c5697fbb84dc92c3/e3959/setLineDash.jpg 636w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/ef4dc9a06709a4a2c5697fbb84dc92c3/c739e/setLineDash.jpg\"\n          alt=\"setLineDash\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>可以通过动态设置<code class=\"language-text\">lineDashOffset</code>来实现蚁线，比如选择 PS 中选区边缘的蚁线。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// 初始lineDashOffset</span>\n<span class=\"token keyword\">let</span> lineDashOffset <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"green\"</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>lineDashOffset <span class=\"token operator\">></span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    lineDashOffset <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 清空当前canvas</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 设置lineDashOffset</span>\n  ctx<span class=\"token punctuation\">.</span>lineDashOffset <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>lineDashOffset\n  <span class=\"token comment\">// 设置实线长度和间隙长度</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">setLineDash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">//绘制一个矩形</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">rect</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 对canvas当前路径描边</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// lineDashOffset偏移加1</span>\n  lineDashOffset <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n  <span class=\"token comment\">// 用浏览器帧速率来反复执行animate函数</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animate<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5bdd5c5a6a0936c949641f522f708753/c59a2/dynamicLineDashOffset.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52.6813880126183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd5wwJD/xAAWEAEBAQAAAAAAAAAAAAAAAAABEAD/2gAIAQEAAQUCjXf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARITH/2gAIAQEAAT8hrCkdRbG0/9oADAMBAAIAAwAAABAgz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAIDAQEAAAAAAAAAAAAAAAABESFhMZH/2gAIAQEAAT8QhYwQqVKol54bDH0f/9k='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/5bdd5c5a6a0936c949641f522f708753/cc182/dynamicLineDashOffset.webp 148w,\n/static/5bdd5c5a6a0936c949641f522f708753/f7e40/dynamicLineDashOffset.webp 295w,\n/static/5bdd5c5a6a0936c949641f522f708753/1a2f4/dynamicLineDashOffset.webp 590w,\n/static/5bdd5c5a6a0936c949641f522f708753/ab069/dynamicLineDashOffset.webp 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/5bdd5c5a6a0936c949641f522f708753/8ee9c/dynamicLineDashOffset.jpg 148w,\n/static/5bdd5c5a6a0936c949641f522f708753/ebbe7/dynamicLineDashOffset.jpg 295w,\n/static/5bdd5c5a6a0936c949641f522f708753/c739e/dynamicLineDashOffset.jpg 590w,\n/static/5bdd5c5a6a0936c949641f522f708753/c59a2/dynamicLineDashOffset.jpg 634w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/5bdd5c5a6a0936c949641f522f708753/c739e/dynamicLineDashOffset.jpg\"\n          alt=\"dynamicLineDashOffset\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n\n        <h3 id='toc-3-3' >\n          小结\n        </h3>\n      \n<p>绘制线段时，要理解 canvas 当前路径概念，某一时刻，canvas 中当前路径只有一条，在开始新的路径时，必须调用<code class=\"language-text\">beginPath()</code>。可以通过设置<code class=\"language-text\">lineWidth</code>，<code class=\"language-text\">lineCap</code>，<code class=\"language-text\">lineJoin</code>设置线段的绘制样式。在描边线段时，可以通过<code class=\"language-text\">strokeStyle</code>来设置线段的颜色。</p>\n<p>canvas 中不仅可以绘制实线，还可以通过<code class=\"language-text\">lineDashOffset</code>和<code class=\"language-text\">setLineDash()</code>来绘制虚线。</p>","tableOfContents":"<ul><li><a href=\"#toc-3-1\">基础知识</a></li><li><a href=\"#toc-3-2\">线段</a></li><li><a href=\"#toc-3-3\">小结</a></li></ul>","frontmatter":{"title":"canvas核心技术-如何绘制线段","date":"July 09, 2018","tags":["canvas"],"zan":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/how_to_draw_line/","previous":{"fields":{"slug":"/post/core_html5_canvas/"},"frontmatter":{"title":"canvas核心技术"}},"next":{"fields":{"slug":"/post/how_to_draw_graphics/"},"frontmatter":{"title":"canvas核心技术-如何绘制图形"}}}}