{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三洋的小站","author":"三洋"}},"markdownRemark":{"id":"0dbd6f3c-4789-5d56-814f-7e1549808c25","excerpt":"ReactMount 为 react-dom 对象提供了和这 2 个方法，其中第一个就是我们常用的输出 react element 到真实的 dom 里。方法实际上提供了三个参数，第一个就是 react element，第二个是页面上真实的 dom，第三个是 callback。如果 react element…","html":"<p>ReactMount 为 react-dom 对象提供了<code class=\"language-text\">render</code>和<code class=\"language-text\">unmountComponentAtNode</code>这 2 个方法，其中第一个<code class=\"language-text\">render</code>就是我们常用的输出 react element 到真实的 dom 里。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ReactMount <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">scrollMonitor</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container<span class=\"token punctuation\">,</span> renderCallback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">renderSubtreeIntoContainer</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">parentComponent<span class=\"token punctuation\">,</span>\n    nextElement<span class=\"token punctuation\">,</span>\n    container<span class=\"token punctuation\">,</span>\n    callback</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">render</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">unmountComponentAtNode</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<!--more-->\n<p><code class=\"language-text\">render</code>方法实际上提供了三个参数，第一个就是 react element，第二个是页面上真实的 dom，第三个是 callback。如果 react element 已经在之前输出到 container 中了，那么再次调用<code class=\"language-text\">render</code>，则只会最小化更新 dom 的变化。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">render</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 验证callback</span>\n  ReactUpdateQueue<span class=\"token punctuation\">.</span><span class=\"token function\">validateCallback</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">,</span> <span class=\"token string\">'ReactDOM.render'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 验证nextElement是否是Rect Element</span>\n  <span class=\"token operator\">!</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">isValidElement</span><span class=\"token punctuation\">(</span>nextElement<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'提示报错'</span> <span class=\"token punctuation\">:</span> vodid <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 验证container</span>\n  <span class=\"token operator\">!</span><span class=\"token function\">isValidContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'提示报错'</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 创建实际node</span>\n  <span class=\"token keyword\">var</span> componentInstance <span class=\"token operator\">=</span> <span class=\"token function\">instantiateReactComponent</span><span class=\"token punctuation\">(</span>nextElement<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 更新到dom</span>\n  <span class=\"token keyword\">var</span> component <span class=\"token operator\">=</span> ReactUpdates<span class=\"token punctuation\">.</span><span class=\"token function\">batchedUpdates</span><span class=\"token punctuation\">(</span>batchedMountComponentIntoNode<span class=\"token punctuation\">,</span> componentInstance<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> shouldReuseMarkup<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>_renderComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 执行回调函数</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">callback</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> componnet<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>react 版本 15.5.4。</p>","frontmatter":{"title":"阅读react-dom源码--ReactMount部分","date":"June 10, 2017"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/reactdom_reactmount_source/","previous":{"fields":{"slug":"/post/reactelement_source/"},"frontmatter":{"title":"阅读react源码--ReactElement部分"}},"next":{"fields":{"slug":"/post/react_component_life_cycle/"},"frontmatter":{"title":"react组件生命周期浅谈"}}}}