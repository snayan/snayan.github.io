{"data":{"site":{"siteMetadata":{"title":"三洋的小站","author":"三洋"}},"markdownRemark":{"id":"0dbd6f3c-4789-5d56-814f-7e1549808c25","excerpt":"ReactMount为react-dom对象提供了和这2个方法，其中第一个就是我们常用的输出react element到真实的dom里。方法实际上提供了三个参数，第一个就是react element，第二个是页面上真实的dom，第三个是callback。如果react element已经在之前输出到container…","html":"<p>ReactMount为react-dom对象提供了<code class=\"language-text\">render</code>和<code class=\"language-text\">unmountComponentAtNode</code>这2个方法，其中第一个<code class=\"language-text\">render</code>就是我们常用的输出react element到真实的dom里。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ReactMount <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">scrollMonitor</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container<span class=\"token punctuation\">,</span> renderCallback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">renderSubtreeIntoContainer</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parentComponent<span class=\"token punctuation\">,</span> nextElement<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">render</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">unmountComponentAtNode</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<!--more-->\n<p><code class=\"language-text\">render</code>方法实际上提供了三个参数，第一个就是react element，第二个是页面上真实的dom，第三个是callback。如果react element已经在之前输出到container中了，那么再次调用<code class=\"language-text\">render</code>，则只会最小化更新dom的变化。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">render</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//验证callback</span>\n  ReactUpdateQueue<span class=\"token punctuation\">.</span><span class=\"token function\">validateCallback</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">,</span> <span class=\"token string\">'ReactDOM.render'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//验证nextElement是否是Rect Element</span>\n  <span class=\"token operator\">!</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">isValidElement</span><span class=\"token punctuation\">(</span>nextElement<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'提示报错'</span> <span class=\"token punctuation\">:</span> vodid <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//验证container</span>\n  <span class=\"token operator\">!</span><span class=\"token function\">isValidContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'提示报错'</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//创建实际node</span>\n  <span class=\"token keyword\">var</span> componentInstance <span class=\"token operator\">=</span> <span class=\"token function\">instantiateReactComponent</span><span class=\"token punctuation\">(</span>nextElement<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//更新到dom</span>\n  <span class=\"token keyword\">var</span> component <span class=\"token operator\">=</span> ReactUpdates<span class=\"token punctuation\">.</span><span class=\"token function\">batchedUpdates</span><span class=\"token punctuation\">(</span>batchedMountComponentIntoNode<span class=\"token punctuation\">,</span> componentInstance<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> shouldReuseMarkup<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>_renderComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//执行回调函数</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">callback</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> componnet<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>react版本15.5.4。</p>","frontmatter":{"title":"阅读react-dom源码--ReactMount部分","date":"June 10, 2017"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/reactdom_reactmount_source/","previous":{"fields":{"slug":"/reactelement_source/"},"frontmatter":{"title":"阅读react源码--ReactElement部分"}},"next":{"fields":{"slug":"/react_component_life_cycle/"},"frontmatter":{"title":"react组件生命周期浅谈"}}}}