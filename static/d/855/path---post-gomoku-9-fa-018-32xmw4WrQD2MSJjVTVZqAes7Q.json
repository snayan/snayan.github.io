{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三羊的小站","author":"三羊","menu":{"search":{"name":"搜索","link":"/search"}}}},"markdownRemark":{"id":"843a710a-20aa-5681-a940-8c0302314124","excerpt":"在某次求职过程中，收到了一个笔试题，要求写一个人机对战的五子棋，题目要求如下：请编写一个单机【五子棋】游戏，要求如下：\n使用原生技术实现，兼容 Chrome 浏览器即可。\n实现胜负判断，并给出赢棋提示；任意玩家赢得棋局，锁定棋盘。\n请尽可能的考虑游戏的扩展性，界面可以使用 DOM / Canvas 实现。考虑后续切换界面实现的方式成本最低。（比如选择使用 DOM 实现界面，需求改变为使用 Canvas 实现时尽可能少的改动代码）。\n实现一个悔棋功能\n实现一个撤销悔棋功能\n实现一个人机对战功能\n尽可能的考虑实现的灵活性和扩展性自己收到这个题目之后感觉有点棘手，自己没有开发过游戏，时间也比较紧。下班之后就开始弄了，简单介绍下自己的实现过程。","html":"<p>在某次求职过程中，收到了一个笔试题，要求写一个人机对战的五子棋，题目要求如下：</p>\n<blockquote>\n<p>请编写一个单机【五子棋】游戏，要求如下：\n使用原生技术实现，兼容 Chrome 浏览器即可。\n实现胜负判断，并给出赢棋提示；任意玩家赢得棋局，锁定棋盘。\n请尽可能的考虑游戏的扩展性，界面可以使用 DOM / Canvas 实现。考虑后续切换界面实现的方式成本最低。（比如选择使用 DOM 实现界面，需求改变为使用 Canvas 实现时尽可能少的改动代码）。\n实现一个悔棋功能\n实现一个撤销悔棋功能\n实现一个人机对战功能\n尽可能的考虑实现的灵活性和扩展性</p>\n</blockquote>\n<p>自己收到这个题目之后感觉有点棘手，自己没有开发过游戏，时间也比较紧。下班之后就开始弄了，简单介绍下自己的实现过程。</p>\n<!--more-->\n<h3>难点</h3>\n<ul>\n<li>机器人自动选择最佳可下棋子的位置</li>\n<li>判断是否胜利</li>\n</ul>\n<h3>思路</h3>\n<ul>\n<li>选择 dom 方式实现，采用坐标系方式计算每个格子的值，对 canvas 不是太熟悉。</li>\n<li>分离 dom 交互的部分，比如画棋盘，画棋子，悔棋等等。</li>\n<li>分离人机对战逻辑部分，比如计算可下区域的逻辑，胜利的逻辑，机器人选择最佳棋子的逻辑，悔棋逻辑，撤销悔棋逻辑等等。</li>\n</ul>\n<h3>实现</h3>\n<p>dom 交互部分比较简单，这里就不说了，只说说人机对战的逻辑部分。</p>\n<p>要实现机器人自动对战，就要让机器人如何能自动选择最佳位置去下。我在实现的时候采用权重法，就是优先选择权重大的格子下，这样才能最大概率的战胜玩家。那么难点就是如何计算可下区域格子的权重大小呢？我把棋盘采用坐标系的方式表示，对每个格子都有一个固定的值，先计算出可选择区域的格子，然后对每个格子计算出这个格子当前的权重（权重和棋子值不一样）。</p>\n<p>第二个难点就是判断每一步都是否胜利结束游戏，五子棋胜利的判断就是一方连续 5 颗棋子，方向有水平方向，垂直方向，45 度方向和 135 度方向，任意一个方向满足都视为胜利。采用坐标法，那么这个计算就非常简单。</p>\n<h4>当前棋子权重计算</h4>\n<p>当前棋子权重的计算，考虑到如何最有利于自己获胜，当前棋子在当前方向的权重，计算规则：</p>\n<ol>\n<li>遇到，是机器人的棋子，则加 10</li>\n<li>遇到，当前格子还是可下区域，则加 1</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>outerMin <span class=\"token operator\">>=</span> lineMin <span class=\"token operator\">&amp;&amp;</span> outerMin <span class=\"token operator\">&lt;=</span> lineMax<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>currents<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>outerMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    winWeight <span class=\"token operator\">+=</span> <span class=\"token number\">10</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">~</span>havenBoardStatus<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>outerMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    winWeight <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>outerMax <span class=\"token operator\">>=</span> lineMin <span class=\"token operator\">&amp;&amp;</span> outerMax <span class=\"token operator\">&lt;=</span> lineMax<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>currents<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>outerMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    winWeight <span class=\"token operator\">+=</span> <span class=\"token number\">10</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">~</span>havenBoardStatus<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>outerMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    winWeight <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>优先级的逻辑</h4>\n<p>再计算了权重之后，首先要考虑优先级，比如成五比其他情况都优先。\n优先级规则如下：</p>\n<ol>\n<li>当前格子能使自己成五胜利，优先级最高，1</li>\n<li>当前格子下了之后，可成四的线路，如果有多条线路，则优先级其次，2。</li>\n<li>当前格子下了之后，可否使自己成四，并且阻止玩家成四，优先级为 3。</li>\n<li>当前格子下了之后，可否使自己成四，并且使自己其他线路成三，优先级为 4。</li>\n<li>当前格子下了之后，可否使自己成四，并且阻止玩家成三，优先级为 5。</li>\n<li>当前格子下了之后，可否阻止玩家成多条线路的四，优先级为 6。</li>\n<li>当前格子下了之后，可否阻止玩家成四，并且其他线路成三，优先级为 7。</li>\n<li>以此类推……</li>\n</ol>\n<h3>效果</h3>\n<p>写完了之后，由于对 Canvas 的扩展性不是很好，所以结果挂了。自己已经尽量抽离了 UI 交互部分和对战逻辑部分，可是对战逻辑部分还是跟 UI 耦合程度还是比较深，主要也是因为自己对 Canvas 不是很熟，后续需要尽量锻炼自己的逻辑抽象思维，准备花时间把数据结构与相关算法在学习一下，<a href=\"https://github.com/snayan/bookLists#2018-%E7%9B%AE%E5%89%8D%E8%AE%A1%E5%88%92\">学习 JavaScript 数据结构与算法(第 2 版)</a>这本书已经加到 2018 的书单计划中了。</p>\n<p>项目地址:<a href=\"https://github.com/snayan/fivepiece\">https://github.com/snayan/fivepiece</a></p>\n<p>最后还是贴一下界面效果图：\n<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/4db5f/fivepiece.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 105.05050505050507%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAADfUlEQVQ4y51VW28SURDuH/TdF33RJ6OJiZrGp8bGeDcao7GJ91ui1qTeYaFQSsG2WttaW2ELLC2XAtvSlrILuwucz5mzgK1iYiSZnDmzM99cz9AHQECIPSRYZm0KU0+J2romYG8J23bExsaG0HVdmKYp2K7z69oCdh/aP/EbYTuBZOQ50pOvgEoS5a0KwuEJBAJBrGayro3o6ou2wOlzPbXIQ9OlVudskFKz60PIe8d+l36XBH9w+iR0bQP2agS1dATWShSmNiEJxRnMKE9wbfAk8V9IFoaRCpOe+73W1rPSYYFqfhegWYKV9MNM+FGJeWFrQTjpMRjLPpn2+0eXUU+OYoe+WakAmqvj8s58YyVEtopobqUZyQUURgnIhvHxyRWcOXGIDEIozr3FkQP7UFgMkEYd1weOYuTueTQzYXI8So4V7MR9xAdgqF7R2l75BYiaTh790Bc+YHVqGHZ2GnVKPTPrgaFFgPISQsM3MKc8gJ0OoZYMYJuiNZb9xAdhLnOEvwGalF49NYYanbDy1OVlYDMBe22WAszh5uAxvLl3Ds2VoEwTuQiqBOja9ACsUf3YI9Y+4f6VfkRGbgNVDXZuBo3SIjlQIfTvJEsjNjGMm2ePEzDVUiPAxF8i5Jqw0vtHlzDvfyxB6plpOIV5WLmvkkf5B7SpEbwcGqTogrKGJtVwD2CnKZ6nVzFw/CBJypSuCqsUQ6P4je6buNh/CC9uDcDRAnIKuDmVuAKDGvRnU2hsHFJap6akoi/gZD7Bobl0spMoLXiwNP4Sa98UFBcUGhWqIY0Nd9rSmA/zyP2ZsqEqMnyLarL9w0MloHrqU4i+vo3TR/aDQkVLX0QjzTMaIh2vLFHvCNs1rKr+rtLWkhdDF06hOP8WIjtB3xQ59CzLzYzI0WFdPs1egNxlOVOJgGwMd/zu5X6U5t/R7I3JVDnNOyQr0NCzjO88l/WEr3eXefpRiGLw5GG8e3iJtsycBGZDGQmdyEdlDWUmcg6DvefQpJSMZEg2IhZ6hrXZN9KgqvokEBPfuXYc7Y7qlugvL2UdRtxDr2IOLXrkVmoUDqVdoSj4NRhtQOY5Mm4cn11AlQD31rDEhUWV5oqpEnO7zNuF74bqk5uHeZZ1Nk817pUbyox/FK3d2wb1Mpr5z2jkv/wXNXNTAkbBBXQ3Ny/xVo8/gn8k3vgu5/wEAw3z3pWDKXAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <picture>\n        <source\n          srcset=\"/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/cc182/fivepiece.webp 148w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/f7e40/fivepiece.webp 295w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/1a2f4/fivepiece.webp 590w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/4837b/fivepiece.webp 885w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/2f819/fivepiece.webp 1180w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/7dd64/fivepiece.webp 1188w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/cf440/fivepiece.png 148w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/d2d38/fivepiece.png 295w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/b9e4f/fivepiece.png 590w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/f9b6a/fivepiece.png 885w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/2d849/fivepiece.png 1180w,\n/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/4db5f/fivepiece.png 1188w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n          src=\"/static/ebbc453ffb45e2f10d5f0e7bd9af85b7/b9e4f/fivepiece.png\"\n          alt=\"fivePiece\"\n          title=\"\"\n        />\n      </picture>\n  </span>\n  </a></p>\n<p>如果想挑战一下的可以开始：<a href=\"https://snayan.github.io/fivepiece/\">https://snayan.github.io/fivepiece/</a></p>","frontmatter":{"title":"简单的五子棋","date":"January 23, 2018","tags":["javascript","game"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/gomoku/","previous":{"fields":{"slug":"/post/summary_of_2017/"},"frontmatter":{"title":"2017年小结"}},"next":{"fields":{"slug":"/post/learn_react16_part1/"},"frontmatter":{"title":"React 16学习(-)"}}}}