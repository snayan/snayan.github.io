{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQD/2gAMAwEAAhADEAAAAcSerUQpOzXUqiMAb//EABsQAAMAAgMAAAAAAAAAAAAAAAABAhESAxQh/9oACAEBAAEFAjzJ1VJcZepyU9x0z//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAADAAIDAAAAAAAAAAAAAAAAASEQERIxMv/aAAgBAQAGPwImPUNtcTodiz//xAAcEAACAgMBAQAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hWbK7l6NWStvasZEW4S7fwfTTAkNzkQZ//9oADAMBAAIAAwAAABAs1wP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EMLbwL//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAECAQE/EIzR4rv/xAAfEAEAAwACAQUAAAAAAAAAAAABABEhMUFRYXGBodH/2gAIAQEAAT8QAjVRsF68R3WyhBpEB4otans9oxQXOZRxVfkow9YivuDFJrEfPmaECm2kqIiV2XP/2Q==","width":40,"height":40,"src":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg","srcSet":"/static/9d156e8486b343189790da372acb0018/987ea/my.jpg 1x,\n/static/9d156e8486b343189790da372acb0018/9c097/my.jpg 1.5x,\n/static/9d156e8486b343189790da372acb0018/bd6c6/my.jpg 2x"}}},"site":{"siteMetadata":{"title":"三羊的小站","author":"三羊","postPath":"/post","contentUrl":"https://github.com/snayan/blog-source/tree/master/content/blog","menu":{"search":{"name":"搜索","link":"/search"}}}},"markdownRemark":{"id":"cd83ef50-ac22-57f0-893b-24326523f68d","excerpt":"现在前端项目的构建一般基本都是基于 webpack 的。项目的技术栈目前比较主流的是 react 全家桶和 vue 全家桶。\n趁空闲，以公司一个项目整理了 webpack 构建常见的流程,这个项目是使用 vue 全家桶开发的。技术栈vuetypescript…","html":"<p>现在前端项目的构建一般基本都是基于 webpack 的。项目的技术栈目前比较主流的是 react 全家桶和 vue 全家桶。\n趁空闲，以公司一个项目整理了 webpack 构建常见的流程,这个项目是使用 vue 全家桶开发的。</p>\n\n          <h3 id='toc-3-1' >\n            技术栈\n          </h3>\n        \n<ul>\n<li>vue</li>\n<li>typescript</li>\n</ul>\n\n          <h3 id='toc-3-2' >\n            浏览器支持\n          </h3>\n        \n<pre><code class=\"language-json\">\"browserslist\": [\n    \"> 1%\",\n    \"last 2 versions\",\n    \"not ie &#x3C;= 9\",\n    \"Android >= 4.3\"\n]\n</code></pre>\n<!--more-->\n\n          <h3 id='toc-3-3' >\n            流程图\n          </h3>\n        \n<p><img src=\"./webpack_build.png\"></p>\n\n          <h3 id='toc-3-4' >\n            功能\n          </h3>\n        \n<ul>\n<li>babel</li>\n<li>postcss</li>\n<li>eslint</li>\n</ul>\n\n          <h4 id='toc-4-1' >\n            babel\n          </h4>\n        \n<blockquote>\n<p>Babel is a JavaScript compiler.</p>\n</blockquote>\n<p>让我们可以在项目中使用较新 JavaScript 特性。可以通过.babelrc文件指定我们需要编译到的目标版本</p>\n<pre><code class=\"language-json\">{\n  \"presets\": [\n    [\n      \"env\",\n      {\n        \"modules\": false,\n        \"useBuiltIns\": \"usage\"\n      }\n    ],\n    \"stage-2\"\n  ],\n  \"plugins\": [\"transform-vue-jsx\", \"transform-runtime\"]\n}\n</code></pre>\n\n          <h4 id='toc-4-2' >\n            postcss\n          </h4>\n        \n<blockquote>\n<p>a tool for transforming styles with JS plugins</p>\n</blockquote>\n<p>可以让我们在项目使用一些较新 css 的特性。可以通过<strong>.postcssrc.js</strong>文件指定我们配置的 postcss 插件</p>\n<ul>\n<li>可以通过 rem 方案来处理移动设备上的适配，在构建过程中，使用了 px2rem 插件来将 px 转为 rem。</li>\n<li>使用了 postcss-import 将@import 引入的 css 文件内容内联到当前文件内</li>\n<li>postcss-url，配合 postcss-import 使用</li>\n<li>postcss-cssnext，使用一些 css 新特性，目前已建议使用 postcss-preset-env 替换。</li>\n<li>postss-pxtorem，将 px 转为 rem</li>\n</ul>\n<pre><code class=\"language-js\">module.exports = {\n  plugins: {\n    \"postcss-import\": {\n      path: \"src/css/\",\n    },\n    \"postcss-url\": {},\n    \"postcss-cssnext\": {},\n    \"postcss-pxtorem\": {\n      rootValue: 75,\n      unitPrecision: 5,\n      propList: [\"*\"],\n      selectorBlackList: [],\n      replace: true,\n      mediaQuery: false,\n      minPixelValue: 2,\n    },\n  },\n}\n</code></pre>\n\n          <h4 id='toc-4-3' >\n            tslint\n          </h4>\n        \n<blockquote>\n<p>An extensible linter for the TypeScript language.</p>\n</blockquote>\n<p>定制项目 javascript 使用的标准化，建议将多个项目统一定制为一套。可以在 tslint.json 中定制项目的检查规则。</p>\n<pre><code class=\"language-json\">{\n  \"extends\": \"tslint:recommended\",\n  \"rulesDirectory\": [\"path/to/custom/rules/directory/\", \"another/path/\"],\n  \"rules\": {\n    \"max-line-length\": {\n      \"options\": [120]\n    },\n    \"new-parens\": true,\n    \"no-arg\": true,\n    \"no-bitwise\": true,\n    \"no-conditional-assignment\": true,\n    \"no-consecutive-blank-lines\": false,\n    \"no-console\": {\n      \"severity\": \"warning\",\n      \"options\": [\"debug\", \"info\", \"log\", \"time\", \"timeEnd\", \"trace\"]\n    }\n  },\n  \"jsRules\": {\n    \"max-line-length\": {\n      \"options\": [120]\n    }\n  }\n}\n</code></pre>\n\n          <h3 id='toc-3-5' >\n            环境配置\n          </h3>\n        \n<p>在配置 webpack 文件时，分 dev 和 prod 环境，不同的环境配置项有所差别，主要体现在 plugin 的使用上。主要有三个 webpack 配置文件</p>\n<ul>\n<li>webpack.base.conf.js，dev 和 prod 公用的基础配置，主要 loader 的配置</li>\n<li>webpack.dev.conf.js，dev 环境的配置，主要配置了 webpack-dev-serve，供开发环境使用</li>\n<li>webpack.prod.conf.js，production 环境的配置，主要增加了一些优化的配置，比如 OptimizeCSSPlugin，UglifyJsPlugin\n可以根据实际业务情况，配置不同环境变量，比如，我整理的这个项目，是会区分不同国家，以及不同的测试部署环境。在区分不同国家，不同部署环境时，采用了 test，staging，live 等环境名称。development 和 production 只是针对开发人员而言的，在本地开发就是 development，代码部署到 test，staging，live 都是 production。对不同国家，不同部署环境，又有 dev.env.js 和 prod.env.js.这两个文件其实是一样的，只不过参数不同而已。可以统一从 process.env.env 和 process.env.cid 拿参数，这样就可以不需要这两个配置文件了，且不需要在 build 脚本中去动态替换 prod.env.js 里的配置项（个人觉得，可以讨论）</li>\n<li>dev.env.js</li>\n</ul>\n<pre><code class=\"language-javascript\">const merge = require(\"webpack-merge\")\nconst prodEnv = require(\"./prod.env\")\n\nmodule.exports = merge(prodEnv, {\n  NODE_ENV: '\"development\"',\n  country: '\"sg\"',\n  environment: '\"test\"',\n})\n</code></pre>\n<ul>\n<li>prod.env.js</li>\n</ul>\n<pre><code class=\"language-javascript\">const COUNTRY = \"sg\"\nconst shopeeEnvironment = \"live\"\n\nmodule.exports = {\n  NODE_ENV: '\"production\"',\n  country: '\"' + COUNTRY + '\"',\n  environment: '\"' + shopeeEnvironment + '\"',\n}\n</code></pre>\n\n          <h3 id='toc-3-6' >\n            使用\n          </h3>\n        \n<ul>\n<li>在 dev 开发环境，需执行<code>npm run start</code>或者<code>yarn start</code></li>\n<li>在 build 时，需执行<code>npm run build</code>或者<code>yarn build</code></li>\n</ul>\n\n          <h3 id='toc-3-7' >\n            其他\n          </h3>\n        \n<ul>\n<li>babel-polyfill，对不同设备对 js 的兼容，<strong>可以考虑使用 polyfill.io，针对具体设备引入具体的 feature</strong></li>\n<li>normalize.css，针对 Html5，样式 reset</li>\n</ul>","tableOfContents":"<ul><li><a href=\"#toc-3-1\">技术栈</a><ul><li><a href=\"#toc-4-1\">babel</a></li><li><a href=\"#toc-4-2\">postcss</a></li><li><a href=\"#toc-4-3\">tslint</a></li></ul></li><li><a href=\"#toc-3-2\">浏览器支持</a><ul></ul></li><li><a href=\"#toc-3-3\">流程图</a><ul></ul></li><li><a href=\"#toc-3-4\">功能</a><ul></ul></li><li><a href=\"#toc-3-5\">环境配置</a><ul></ul></li><li><a href=\"#toc-3-6\">使用</a><ul></ul></li><li><a href=\"#toc-3-7\">其他</a><ul></ul></li></ul>","frontmatter":{"title":"webpack构建常见流程","date":"June 27, 2018","tags":["webpack"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/process_of_webpack_build_project/","previous":{"fields":{"slug":"/post/vue_technology_stack/"},"frontmatter":{"title":"vue 全家桶初探"}},"next":{"fields":{"slug":"/post/core_html5_canvas/"},"frontmatter":{"title":"canvas核心技术"}}}}